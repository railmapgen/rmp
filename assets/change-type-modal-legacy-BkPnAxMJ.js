!function(){function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function t(t){for(var n=1;n<arguments.length;n++){var s=null!=arguments[n]?arguments[n]:{};n%2?e(Object(s),!0).forEach((function(e){r(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):e(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function r(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}System.register(["./chakra-legacy-DQqN9Dqk.js","./index-legacy-BG7b_zT7.js","./react-legacy-BuT440iH.js","./master-manager-legacy-CKO8SaR6.js"],(function(e,r){"use strict";var n,s,a,i,o,l,c,d,u,g,h,p,y,b,f,m,j,S,O,x,v,C,A,E,T,w,N,P,L,k,I,W,z,D,M,R,_,B,F,Z;return{setters:[e=>{n=e.j,s=e.ag,a=e.M,i=e.ah,o=e.J,l=e.N,c=e.K,d=e.L,u=e.aG,g=e.aH,h=e.aI,p=e.B,y=e.aJ,b=e.aK,f=e.O,m=e.t,j=e.aw},e=>{S=e.d,O=e.S,x=e.aD,v=e.q,C=e.L,A=e.o,E=e.p,T=e.c,w=e.e,N=e.w,P=e.x,L=e.y,k=e.C,I=e.M,W=e.Z,z=e.W,D=e.R,M=e._,R=e.k},e=>{_=e.u,B=e.b},e=>{F=e.s,Z=e.k}],execute:function(){const r=[O.ShmetroBasic2020,O.LondonTubeBasic,O.ShanghaiSuburbanRailway],q=e("b",((e,n,s)=>{const a=e.getNodeAttribute(n,"type"),i=structuredClone(e.getNodeAttribute(n,a).names);for(let t=0;t<Math.abs(F[s].defaultAttrs.names.length-i.length);t++)F[s].defaultAttrs.names.length>i.length?i.push("Stn"):i.pop();const o=t(t({},F[s].defaultAttrs),{},{names:i});Object.values(r).includes(a)&&Object.values(r).includes(s)||(o.nameOffsetX=e.getNodeAttribute(n,a).nameOffsetX,o.nameOffsetY=e.getNodeAttribute(n,a).nameOffsetY),S.has(s)&&S.has(a)&&(o.color=structuredClone(e.getNodeAttribute(n,a).color)),e.removeNodeAttribute(n,a),e.mergeNodeAttributes(n,{type:s,[s]:o})})),H=e("c",((e,t,r,n)=>{const s=e.getEdgeAttribute(t,"type"),a=e.getEdgeAttribute(t,"style");if(x[a].metadata.supportLinePathType.includes(r)){const a=structuredClone(v[r].defaultAttrs);let i=-1;if(n&&r!==C.Simple){const[n,s]=e.extremities(t),o=a.startFrom;i=A(e,r,n,s,o)}e.setEdgeAttribute(t,"parallelIndex",i),e.removeEdgeAttribute(t,s),e.mergeEdgeAttributes(t,{type:r,[r]:a})}})),J=e("a",((e,t,r,n)=>{const s=e.getEdgeAttribute(t,"type"),a=e.getEdgeAttribute(t,"style");if(x[r].metadata.supportLinePathType.includes(s)){const s=e.getEdgeAttribute(t,"zIndex"),i=e.getEdgeAttribute(t,a);e.removeEdgeAttribute(t,a);const o=structuredClone(x[r].defaultAttrs);S.has(a)&&S.has(r)?o.color=i.color:S.has(r)&&n&&(o.color=n),e.mergeEdgeAttributes(t,{style:r,[r]:o}),r===E.River?e.setEdgeAttribute(t,"zIndex",-5):e.setEdgeAttribute(t,"zIndex",null!=s?s:0)}}));e("C",(e=>{const{isOpen:r,onClose:A,isSelect:K,filter:U}=e,{t:X}=_(),Y=T(),{selected:G}=w((e=>e.runtime)),{preference:{autoParallel:Q}}=w((e=>e.app)),{activeSubscriptions:V}=w((e=>e.account)),$=B.useCallback((()=>{Y(N()),Y(P()),Y(L(ee.current.export()))}),[Y,N,P,L]),ee=B.useRef(window.graph),te=t({any:X("header.settings.procedures.changeType.any")},Object.fromEntries(Object.entries(v).map((([e,t])=>[e,X(t.metadata.displayName).toString()])))),re=t({any:X("header.settings.procedures.changeType.any")},Object.fromEntries(Object.entries(x).map((([e,t])=>[e,X(t.metadata.displayName).toString()])))),ne=t({any:X("header.settings.procedures.changeType.any")},Object.fromEntries(Object.entries(F).map((([e,t])=>[e,X(t.metadata.displayName).toString()])))),se={id:"any",theme:[k.Other,"other","#ffffff",I.black],value:X("header.settings.procedures.changeType.any")},[ae,ie]=B.useState(!1),[oe,le]=B.useState(0),[ce,de]=B.useState(!1),[ue,ge]=B.useState("any"),[he,pe]=B.useState(O.ShmetroBasic),[ye,be]=B.useState(!1),[fe,me]=B.useState("any"),[je,Se]=B.useState(E.SingleColor),[Oe,xe]=B.useState(!1),[ve,Ce]=B.useState("any"),[Ae,Ee]=B.useState(C.Diagonal),[Te,we]=B.useState(!1),[Ne,Pe]=B.useState(se),{theme:Le,requestThemeChange:ke}=W(),[Ie,We]=B.useState([]),ze=[{id:"changeZIndex",title:X("header.settings.procedures.changeZIndex"),onClose:()=>ie(!ae),field:[{type:"select",label:X("panel.details.info.zIndex"),value:oe,options:Object.fromEntries(Array.from({length:11},((e,t)=>[t-5,(t-5).toString()]))),onChange:e=>le(Number(e))}]},{id:"changeStationType",title:X("header.settings.procedures.changeStationType.title"),onClose:()=>de(!ce),field:[{type:"select",label:X("header.settings.procedures.changeStationType.changeFrom"),options:ne,value:ue,disabledOptions:[he],onChange:e=>ge(e)},{type:"select",label:X("header.settings.procedures.changeStationType.changeTo"),options:ne,value:he,disabledOptions:["any",ue],onChange:e=>pe(e)}]},{id:"changeLineStyleType",title:X("header.settings.procedures.changeLineStyleType.title"),onClose:()=>be(!ye),field:[{type:"select",label:X("header.settings.procedures.changeLineStyleType.changeFrom"),options:re,value:fe,disabledOptions:[je],onChange:e=>me(e)},{type:"select",label:X("header.settings.procedures.changeLineStyleType.changeTo"),options:re,value:je,disabledOptions:["any",fe],onChange:e=>Se(e)}]},{id:"changeLinePathType",title:X("header.settings.procedures.changeLinePathType.title"),onClose:()=>xe(!Oe),field:[{type:"select",label:X("header.settings.procedures.changeLinePathType.changeFrom"),options:te,value:ve,disabledOptions:[Ae],onChange:e=>Ce(e)},{type:"select",label:X("header.settings.procedures.changeLinePathType.changeTo"),options:te,value:Ae,disabledOptions:["any","simple",ve],onChange:e=>Ee(e)}]},{id:"changeColor",title:X("header.settings.procedures.changeColor.title"),onClose:()=>we(!Te),field:[{type:"custom",label:X("header.settings.procedures.changeColor.changeFrom"),component:n.jsx(z,{data:Ie,displayHandler:e=>n.jsx(D,{name:e.value,fg:e.theme[3],bg:e.theme[2],title:e.theme[1],sx:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis"}}),filter:(e,t)=>t.id.toLowerCase().includes(e.toLowerCase())||Object.values(t.id).some((t=>t.toLowerCase().includes(e.toLowerCase()))),value:Ne.value,onChange:e=>Pe(e)})},{type:"custom",label:X("header.settings.procedures.changeColor.changeTo"),component:n.jsx(M,{theme:Le,onClick:ke})}]}];B.useEffect((()=>{r&&(ie(!1),de(!1),be(!1),xe(!1),we(!1),le(0),We([se,...Z(ee.current,K?[...G].filter((e=>e.startsWith("stn")||e.startsWith("misc_node"))):ee.current.nodes(),K?[...G].filter((e=>e.startsWith("line"))):ee.current.edges()).map((e=>({id:e.toString(),theme:e,value:"other"===e[1]?e[2]:e[1]})))]),Pe(se))}),[r]);return n.jsxs(s,{isOpen:r,onClose:A,size:"md",scrollBehavior:"inside",children:[n.jsx(a,{}),n.jsxs(i,{children:[n.jsxs(o,{children:[n.jsx(l,{as:"b",fontSize:"xl",children:X(K?"panel.details.multipleSelection.change":"header.settings.procedures.changeType.title")}),n.jsx(c,{})]}),n.jsx(d,{children:n.jsx(u,{allowMultiple:!0,children:ze.map((e=>n.jsxs(g,{children:[n.jsxs(h,{onClick:e.onClose,children:[n.jsx(p,{as:"span",flex:"1",textAlign:"left",children:n.jsx(l,{as:"b",fontSize:"md",children:e.title})}),n.jsx(y,{})]}),n.jsx(b,{pb:4,children:n.jsx(R,{fields:e.field,minW:270})})]},e.id)))})}),n.jsxs(f,{children:[n.jsx(m,{colorScheme:"blue",variant:"outline",mr:"1",onClick:A,children:X("cancel")}),n.jsx(j,{label:X("header.settings.pro"),isOpen:!V.RMP_CLOUD,children:n.jsx(m,{colorScheme:"red",mr:"1",onClick:()=>{const e=null!=U&&U.includes("station")?[...G].filter((e=>e.startsWith("stn"))):K?[]:ee.current.filterNodes((e=>e.startsWith("stn"))),t=null!=U&&U.includes("misc-node")?[...G].filter((e=>e.startsWith("misc_node"))):K?[]:ee.current.filterNodes((e=>e.startsWith("misc_node"))),r=K?[...G].filter((e=>e.startsWith("line"))):ee.current.edges();U&&!U.includes("station")||!ce||((e,t,r,n)=>{n.filter((r=>"any"===t||e.getNodeAttribute(r,"type")===t)).forEach((t=>{q(e,t,r)}))})(ee.current,ue,he,e),U&&!U.includes("line")||!ye||((e,t,r,n,s)=>{s.filter((r=>"any"===t||e.getEdgeAttribute(r,"style")===t)).forEach((t=>{J(e,t,r,n)}))})(ee.current,fe,je,Le,r),U&&!U.includes("line")||!Oe||((e,t,r,n,s)=>{n.filter((r=>"any"===t||e.getEdgeAttribute(r,"type")===t)).forEach((t=>{H(e,t,r,s)}))})(ee.current,ve,Ae,r,Q),Te&&(U&&!U.includes("line")||((e,t,r,n)=>{n.filter((t=>S.has(e.getEdgeAttribute(t,"style")))).forEach((n=>{const s=e.getEdgeAttributes(n),a=s[s.style].color;("any"===t||a[0]==t[0]&&a[1]==t[1]&&a[2]==t[2]&&a[3]==t[3])&&e.mergeEdgeAttributes(n,{[s.style]:{color:r}})}))})(ee.current,"any"===Ne.id?"any":Ne.theme,Le,r),(!U||U.includes("misc-node")||U.includes("station"))&&((e,t,r,n,s)=>{[...n,...s].forEach((n=>{const s=e.getNodeAttributes(n).type,a=e.getNodeAttribute(n,s);if(void 0!==a.color){const e=a.color;("any"===t||e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]&&e[3]==t[3])&&(a.color=r)}e.mergeNodeAttributes(n,{[s]:a})}))})(ee.current,"any"===Ne.id?"any":Ne.theme,Le,e,t)),ae&&((e,t,r,n,s)=>{[...t,...r].forEach((t=>{e.setNodeAttribute(t,"zIndex",s)})),n.forEach((t=>{e.setEdgeAttribute(t,"zIndex",s)}))})(ee.current,e,t,r,oe),$(),A()},isDisabled:!(V.RMP_CLOUD&&(ae||ce||ye||Oe||Te)),children:X("apply")})})]})]})]})}))}}}))}();
