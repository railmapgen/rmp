import{S as l,d as f,aT as g,t as O,L as C,p as x,q as v,C as S}from"./index-DQJ2dZ03.js";import{s as A}from"./master-manager-BcXwGCtA.js";const m=[l.ShmetroBasic2020,l.LondonTubeBasic,l.ShanghaiSuburbanRailway,l.OsakaMetro],B=(e,t)=>{const o=e.getNodeAttribute(t,"type"),r=e.getNodeAttribute(t,o);return!!(r&&"transfer"in r)},y=(e,t,o)=>{const r=e.getNodeAttribute(t,"type"),s=structuredClone(e.getNodeAttribute(t,r).names);for(let i=0;i<Math.abs(A[o].defaultAttrs.names.length-s.length);i++)A[o].defaultAttrs.names.length>s.length?s.push("Stn"):s.pop();const n={...A[o].defaultAttrs,names:s};(!Object.values(m).includes(r)||!Object.values(m).includes(o))&&(n.nameOffsetX=e.getNodeAttribute(t,r).nameOffsetX,n.nameOffsetY=e.getNodeAttribute(t,r).nameOffsetY),f.has(o)&&f.has(r)&&(n.color=structuredClone(e.getNodeAttribute(t,r).color)),e.removeNodeAttribute(t,r),e.mergeNodeAttributes(t,{type:o,[o]:n})},X=(e,t,o,r)=>r.filter(s=>t==="any"||e.getNodeAttribute(s,"type")===t).forEach(s=>{y(e,s,o)}),z=(e,t,o,r)=>{const s=e.getEdgeAttribute(t,"type"),n=e.getEdgeAttribute(t,"style");if(g[n].metadata.supportLinePathType.includes(o)){const i=structuredClone(O[o].defaultAttrs);let a=-1;if(r&&o!==C.Simple){const[c,d]=e.extremities(t),b=i.startFrom;a=x(e,o,c,d,b)}e.setEdgeAttribute(t,"parallelIndex",a),e.removeEdgeAttribute(t,s),e.mergeEdgeAttributes(t,{type:o,[o]:i})}},Y=(e,t,o,r,s)=>r.filter(n=>t==="any"||e.getEdgeAttribute(n,"type")===t).forEach(n=>{z(e,n,o,s)}),j=(e,t,o,r)=>{const s=e.getEdgeAttribute(t,"type"),n=e.getEdgeAttribute(t,"style");if(g[o].metadata.supportLinePathType.includes(s)){const i=e.getEdgeAttribute(t,"zIndex"),a=e.getEdgeAttribute(t,n);e.removeEdgeAttribute(t,n);const c=structuredClone(g[o].defaultAttrs);f.has(n)&&f.has(o)?c.color=a.color:f.has(o)&&r&&(c.color=r),e.mergeEdgeAttributes(t,{style:o,[o]:c}),o===v.River?e.setEdgeAttribute(t,"zIndex",-5):e.setEdgeAttribute(t,"zIndex",i!=null?i:0)}},$=(e,t,o,r,s)=>s.filter(n=>t==="any"||e.getEdgeAttribute(n,"style")===t).forEach(n=>{j(e,n,o,r)}),q=(e,t,o,r)=>r.filter(s=>f.has(e.getEdgeAttribute(s,"style"))).forEach(s=>{const n=e.getEdgeAttributes(s),i=n[n.style].color;(t==="any"||i[0]==t[0]&&i[1]==t[1]&&i[2]==t[2]&&i[3]==t[3])&&e.mergeEdgeAttributes(s,{[n.style]:{color:o}})}),k=(e,t,o,r,s)=>{[...r,...s].forEach(n=>{const i=e.getNodeAttributes(n).type,a=e.getNodeAttribute(n,i);if(a.color!==void 0){const c=a.color;(t==="any"||c[0]==t[0]&&c[1]==t[1]&&c[2]==t[2]&&c[3]==t[3])&&(a.color=o)}e.mergeNodeAttributes(n,{[i]:a})})},D=(e,t,o,r,s)=>{[...t,...o].forEach(n=>{e.setNodeAttribute(n,"zIndex",s)}),r.forEach(n=>{e.setEdgeAttribute(n,"zIndex",s)})},P=e=>e.map(t=>[t[0],t[1],t[2],t[3],"",""]),W=(e,t,o,r)=>{const s=e.getNodeAttribute(t,o);s&&(s.transfer=[r],e.mergeNodeAttributes(t,{[o]:s}))},N=(e,t,o)=>{const r=i=>{if(i.endsWith("-int")&&o==="basic")return i.replace(/-int$/,"-basic");if(i.endsWith("-basic")&&o==="int")return i.replace(/-basic$/,"-int")},s=e.getNodeAttribute(t,"type"),n=r(s);if(n&&Object.values(l).includes(n))return n},I=(e,t)=>{const o=e.directedEdges(t),r=new Set,s=[],n=i=>i[0]!==S.Other?i[0].toString()+"/"+i[1].toString():i[2].toString()+"/"+i[3].toString();for(const i of o){const a=e.getEdgeAttributes(i).style;if(!f.has(a))continue;const c=e.getEdgeAttributes(i)[a].color;r.has(n(c))||(r.add(n(c)),s.push(c))}return{lineColorStr:r,lineColor:s}},h=(e,t)=>{const{lineColorStr:o,lineColor:r}=I(e,t);if(o.size>1){const s=N(e,t,"int");if(s)return y(e,t,s),!0}else if(o.size===1){const s=N(e,t,"basic");if(s)return y(e,t,s),k(e,"any",r[0],[t],[]),!0}return!1},J=(e,t)=>{var b,E;if(!B(e,t))return!1;const{lineColorStr:o,lineColor:r}=I(e,t),s=e.getNodeAttribute(t,"type"),n=u=>u[0]!==S.Other?u[0].toString()+"/"+u[1].toString():u[2].toString()+"/"+u[3].toString(),i=(E=(b=e.getNodeAttribute(t,s).transfer)==null?void 0:b.at(0))!=null?E:[],a=i.filter(u=>o.has(n(u))),c=P(r.filter(u=>!i.find(T=>n(u)===n(T)))),d=[...a,...c];return JSON.stringify(i)!==JSON.stringify(d)?(W(e,t,s,d),!0):!1},U=(e,t)=>{h(e,t),J(e,t)};export{z as a,j as b,U as c,y as d,J as e,X as f,$ as g,Y as h,q as i,k as j,D as k};
