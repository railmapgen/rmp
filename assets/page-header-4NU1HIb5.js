import{j as e,at as Y,$ as F,au as J,a1 as q,a2 as X,a3 as Q,g as Ms,av as at,a4 as w,B as A,aw as Ce,ax as Ne,ay as ne,az as re,aA as oe,h as $e,O as R,a5 as xe,aB as lt,aC as ct,aD as ye,a7 as O,aE as N,a6 as Ds,aF as fs,aG as js,af as ee,aH as bs,aI as ce,U as le,aJ as es,aK as dt,aL as Us,al as Zs,d as Vs,R as Ks,q as Ys,Z as Fs,aM as ze,aN as ht,ak as De,ae as ut,aO as pt,aP as gt,aQ as D,aR as As,aS as mt,aT as k,aU as C,W as xt,m as ie,a8 as ft,a9 as jt}from"./chakra-xNcrfRXW.js";import{u as bt,r as E,C as wt,M as ws,n as ls,L as Js,S as I,R as Ts,a as qs,b as T,c as P,d as B,e as St,f as yt,g as Ct,h as zt,i as ke,E as Me,s as vt,j as Ye,k as ss,m as kt,l as Ot,o as Rs,p as Ss,q as K,t as V,v as se,w as Xs,x as Qs,y as cs,z as Oe,A as Ie,B as Es,D as Ns,F as Mt,G as At,H as Tt,I as Rt,J as Et,K as _s,N as Nt,O as _t,P as It,Q as Ht,T as Wt,U as Lt,V as Bt,W as Pt,X as Gt,Y as Dt,Z as Ut,_ as Zt,$ as Vt,a0 as Kt,a1 as Yt,a2 as Ft,a3 as Ue,a4 as fe,a5 as Jt,a6 as qt,a7 as Xt,a8 as Qt,a9 as pe,aa as $t,ab as en,ac as Is,ad as sn,ae as ts,af as tn,ag as nn,ah as rn,ai as on,aj as an,ak as ln,al as cn,am as dn,an as hn,ao as un}from"./index-NAgBcBOW.js";import{u as L,b,r as Ze,T as Hs}from"./react-D-_si4LB.js";import{d as ds,m as pn,a as gn,i as mn,s as xn,u as ys,M as fn}from"./master-manager-DrmxtOAg.js";import{C as jn}from"./change-type-modal-DqdDgqHv.js";var Ws=function(s){return bt(E.ready(),s)},bn={ar:{ar:"العربية",en:"Arabic",ko:"아랍어","zh-Hans":"阿拉伯文","zh-Hant":"阿拉伯文"},az:{az:"Azərbaycanca",en:"Azerbaijani",ko:"아제르바이잔어","zh-Hans":"阿塞拜疆文","zh-Hant":"阿塞拜疆文"},ca:{ca:"Català",en:"Catalan",ko:"카탈루냐어","zh-Hans":"加泰罗尼亚文","zh-Hant":"加泰隆尼亞文"},da:{da:"Dansk",en:"Danish",ko:"덴마크어","zh-Hans":"丹麦文","zh-Hant":"丹麥文"},de:{de:"Deutsch",en:"German",ko:"독일어","zh-Hans":"德文","zh-Hant":"德文"},el:{el:"Ελληνικά",en:"Greek",ko:"그리스어","zh-Hans":"希腊文","zh-Hant":"希臘文"},en:{en:"English",ja:"英語",ko:"영어","zh-Hans":"英文","zh-Hant":"英文"},es:{en:"Spanish",es:"Español",ko:"스페인어","zh-Hans":"西班牙文","zh-Hant":"西班牙文"},fa:{en:"Persian",fa:"فارسی",ko:"페르시아어","zh-Hans":"波斯文","zh-Hant":"波斯文"},fr:{en:"French",fr:"Français",ko:"프랑스어","zh-Hans":"法文","zh-Hant":"法文"},ga:{en:"Irish",ga:"Gaeilge",ko:"아일랜드어","zh-Hans":"爱尔兰文","zh-Hant":"愛爾蘭文"},gd:{en:"Scottish Gaelic",gd:"Gàidhlig",ko:"스코틀랜드 게일어","zh-Hans":"苏格兰盖尔文","zh-Hant":"蘇格蘭蓋爾文"},hi:{en:"Hindi",hi:"हिन्दी",ko:"힌디어","zh-Hans":"印地文","zh-Hant":"印地文"},hu:{en:"Hungarian",hu:"Magyar",ko:"헝가리어","zh-Hans":"匈牙利文","zh-Hant":"匈牙利文"},id:{en:"Indoesian",id:"Bahasa Indonesia",ko:"인도네시아어","zh-Hans":"印尼文","zh-Hant":"印尼文"},it:{en:"Italian",it:"Italiano",ko:"이탈리아어","zh-Hans":"意大利文","zh-Hant":"意大利文"},ja:{en:"Japanese",ja:"日本語",ko:"일본어","zh-Hans":"日文","zh-Hant":"日文"},kk:{en:"Kazakh",kk:"Қазақша",ko:"카자흐어","zh-Hans":"哈萨克文","zh-Hant":"哈薩克文"},ko:{en:"Korean",ja:"韓国語",ko:"한국어","zh-Hans":"韩文","zh-Hant":"韓文"},ms:{en:"Malay",ko:"말레이어",ms:"Bahasa Melayu","zh-Hans":"马来文","zh-Hant":"馬來文"},no:{en:"Norwegian",ko:"노르웨이어",no:"Norsk","zh-Hans":"挪威文","zh-Hant":"挪威文"},pl:{en:"Polish",ko:"폴란드어",pl:"Polski","zh-Hans":"波兰文","zh-Hant":"波蘭文"},pt:{en:"Portuguese",ko:"포르투갈어",pt:"Português","zh-Hans":"葡萄牙文","zh-Hant":"葡萄牙文"},ro:{en:"Romanian",ko:"루마니아어",ro:"Română","zh-Hans":"罗马尼亚文","zh-Hant":"羅馬尼亞文"},ru:{en:"Russian",ko:"러시아어",ru:"Русский","zh-Hans":"俄文","zh-Hant":"俄文"},sv:{en:"Swedish",ko:"스웨덴어",sv:"Svenska","zh-Hans":"瑞典文","zh-Hant":"瑞典文"},th:{en:"Thai",ko:"태국어",th:"ภาษาไทย","zh-Hans":"泰文","zh-Hant":"泰文"},tr:{en:"Turkish",ko:"튀르키예어",tr:"Türkçe","zh-Hans":"土耳其文","zh-Hant":"土耳其文"},uk:{en:"Ukrainian",ko:"우크라이나어",uk:"Українська","zh-Hans":"乌克兰文","zh-Hant":"烏克蘭文"},ur:{en:"Urdo",ko:"우르두어",ur:"اردو","zh-Hans":"乌尔都文","zh-Hant":"烏爾都文"},uz:{en:"Uzbek",ko:"우즈베크어",uz:"Oʻzbekcha","zh-Hans":"乌兹别克文","zh-Hant":"烏茲別克文"},vi:{en:"Vietnamese",ko:"베트남어",vi:"Tiếng Việt","zh-Hans":"越南文","zh-Hant":"越南文"},zh:{en:"Chinese",ja:"中国語",ko:"중국어",zh:"中文","zh-Hans":"中文","zh-Hant":"中文"},"zh-Hans":{en:"Simplified Chinese",ja:"中国語（簡体字）",ko:"중국어 간체자","zh-Hans":"简体中文","zh-Hant":"簡體中文"},"zh-Hant":{en:"Traditional Chinese",ja:"中国語（繁体字）",ko:"중국어 정체자","zh-Hans":"繁体中文","zh-Hant":"繁體中文"}};const wn="data:image/png;base64,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",Sn="data:image/svg+xml,%3csvg%20width='98'%20height='96'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M48.854%200C21.839%200%200%2022%200%2049.217c0%2021.756%2013.993%2040.172%2033.405%2046.69%202.427.49%203.316-1.059%203.316-2.362%200-1.141-.08-5.052-.08-9.127-13.59%202.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015%204.934.326%207.523%205.052%207.523%205.052%204.367%207.496%2011.404%205.378%2014.235%204.074.404-3.178%201.699-5.378%203.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283%200-5.378%201.94-9.778%205.014-13.2-.485-1.222-2.184-6.275.486-13.038%200%200%204.125-1.304%2013.426%205.052a46.97%2046.97%200%200%201%2012.214-1.63c4.125%200%208.33.571%2012.213%201.63%209.302-6.356%2013.427-5.052%2013.427-5.052%202.67%206.763.97%2011.816.485%2013.038%203.155%203.422%205.015%207.822%205.015%2013.2%200%2018.905-11.404%2023.06-22.324%2024.283%201.78%201.548%203.316%204.481%203.316%209.126%200%206.6-.08%2011.897-.08%2013.526%200%201.304.89%202.853%203.316%202.364%2019.412-6.52%2033.405-24.935%2033.405-46.691C97.707%2022%2075.788%200%2048.854%200z'%20fill='%2324292f'/%3e%3c/svg%3e",yn="/rmp/assets/opencollective-icon-Ciasch0w.webp",Cn="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2023.0.1,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%20270%20270'%20style='enable-background:new%200%200%20270%20270;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%23E01E5A;}%20.st1{fill:%2336C5F0;}%20.st2{fill:%232EB67D;}%20.st3{fill:%23ECB22E;}%20%3c/style%3e%3cg%3e%3cg%3e%3cpath%20class='st0'%20d='M99.4,151.2c0,7.1-5.8,12.9-12.9,12.9c-7.1,0-12.9-5.8-12.9-12.9c0-7.1,5.8-12.9,12.9-12.9h12.9V151.2z'/%3e%3cpath%20class='st0'%20d='M105.9,151.2c0-7.1,5.8-12.9,12.9-12.9s12.9,5.8,12.9,12.9v32.3c0,7.1-5.8,12.9-12.9,12.9%20s-12.9-5.8-12.9-12.9V151.2z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st1'%20d='M118.8,99.4c-7.1,0-12.9-5.8-12.9-12.9c0-7.1,5.8-12.9,12.9-12.9s12.9,5.8,12.9,12.9v12.9H118.8z'/%3e%3cpath%20class='st1'%20d='M118.8,105.9c7.1,0,12.9,5.8,12.9,12.9s-5.8,12.9-12.9,12.9H86.5c-7.1,0-12.9-5.8-12.9-12.9%20s5.8-12.9,12.9-12.9H118.8z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st2'%20d='M170.6,118.8c0-7.1,5.8-12.9,12.9-12.9c7.1,0,12.9,5.8,12.9,12.9s-5.8,12.9-12.9,12.9h-12.9V118.8z'/%3e%3cpath%20class='st2'%20d='M164.1,118.8c0,7.1-5.8,12.9-12.9,12.9c-7.1,0-12.9-5.8-12.9-12.9V86.5c0-7.1,5.8-12.9,12.9-12.9%20c7.1,0,12.9,5.8,12.9,12.9V118.8z'/%3e%3c/g%3e%3cg%3e%3cpath%20class='st3'%20d='M151.2,170.6c7.1,0,12.9,5.8,12.9,12.9c0,7.1-5.8,12.9-12.9,12.9c-7.1,0-12.9-5.8-12.9-12.9v-12.9H151.2z'/%3e%3cpath%20class='st3'%20d='M151.2,164.1c-7.1,0-12.9-5.8-12.9-12.9c0-7.1,5.8-12.9,12.9-12.9h32.3c7.1,0,12.9,5.8,12.9,12.9%20c0,7.1-5.8,12.9-12.9,12.9H151.2z'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",zn=s=>{const{isOpen:a,onClose:i}=s,{t:n}=L(),o=E.getAppVersion();return e.jsxs(Y,{isOpen:a,onClose:i,size:"xl",scrollBehavior:"inside",children:[e.jsx(F,{}),e.jsxs(J,{children:[e.jsx(q,{children:n("header.about.title")}),e.jsx(X,{}),e.jsxs(Q,{paddingBottom:10,children:[e.jsxs(Ms,{direction:"row",children:[e.jsx(at,{boxSize:"128px",src:"/rmp//logo192.png"}),e.jsxs(Ms,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:[e.jsx(w,{fontSize:"xl",as:"b",children:n("header.about.rmp")}),e.jsx(w,{children:o}),e.jsx(w,{}),e.jsx(w,{fontSize:"sm",children:n("header.about.railmapgen")})]})]}),e.jsx(A,{margin:5,children:e.jsx(w,{fontSize:"xl",children:n("header.about.desc")})}),e.jsx(Ce,{as:"h5",size:"sm",mt:3,mb:2,children:n("header.about.contributors")}),e.jsx(Ce,{as:"h6",size:"xs",my:2,children:n("header.about.coreContributors")}),e.jsxs(Ne,{children:[e.jsxs(ne,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/thekingofcity","_blank"),cursor:"pointer",children:[e.jsx(re,{src:"https://github.com/thekingofcity.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs(oe,{display:"block",width:"100%",children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:"thekingofcity"}),e.jsx(w,{fontSize:"sm",children:n("header.about.content1")}),e.jsx(w,{fontSize:"sm",align:"right",mb:1,children:n("header.about.content2")})]})]}),e.jsxs(ne,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/langonginc","_blank"),cursor:"pointer",children:[e.jsx(re,{src:"https://github.com/langonginc.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs(oe,{display:"block",width:"100%",children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:"langonginc"}),e.jsx(w,{fontSize:"sm",children:n("header.about.langonginc")}),e.jsx(w,{fontSize:"sm",align:"right",mb:1,children:"--Avicii"})]})]})]}),e.jsx(Ce,{as:"h6",size:"xs",my:2,children:n("header.about.styleContributors")}),e.jsxs(Ne,{children:[e.jsxs(ne,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/203IhzElttil","_blank"),cursor:"pointer",children:[e.jsx(re,{src:"https://github.com/203IhzElttil.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs(oe,{display:"block",width:"100%",children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:"203IhzElttil"}),e.jsx(w,{fontSize:"sm",mb:1,children:n("header.about.203IhzElttil")})]})]}),e.jsxs(ne,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/Swiftiecott","_blank"),cursor:"pointer",children:[e.jsx(re,{src:"https://github.com/Swiftiecott.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs(oe,{display:"block",width:"100%",children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:"Swiftiecott"}),e.jsx(w,{fontSize:"sm",mb:1,children:n("header.about.Swiftiecott")})]})]}),e.jsxs(ne,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/Minwtraft","_blank"),cursor:"pointer",children:[e.jsx(re,{src:"https://github.com/Minwtraft.png",size:"lg",my:2,ml:-1,mr:2}),e.jsxs(oe,{display:"block",width:"100%",children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:"Minwtraft"}),e.jsx(w,{fontSize:"sm",mb:1,children:n("header.about.Minwtraft")})]})]})]}),e.jsx(Ce,{as:"h5",size:"sm",mt:3,mb:2,children:n("header.about.contactUs")}),e.jsxs(Ne,{children:[e.jsxs(ne,{size:"lg",w:"85%",onClick:()=>window.open("https://github.com/railmapgen/rmp/issues","_blank"),cursor:"pointer",children:[e.jsx(re,{src:Sn,size:"lg",my:2,ml:-1,mr:2}),e.jsxs(oe,{display:"block",width:"100%",children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:n("header.about.github")}),e.jsx(w,{fontSize:"sm",children:n("header.about.githubContent")})]})]}),e.jsxs(ne,{size:"lg",w:"85%",onClick:()=>window.open("https://join.slack.com/t/railmapgenerator/shared_invite/zt-1odhhta3n-DdZF~fnVwo_q0S0RJmgV8A","_blank"),cursor:"pointer",children:[e.jsx(re,{src:Cn,size:"lg",my:2,ml:-1,mr:2}),e.jsxs(oe,{display:"block",width:"100%",children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:n("header.about.slack")}),e.jsx(w,{fontSize:"sm",children:n("header.about.slackContent")}),e.jsx(w,{fontSize:"sm",as:"i",children:"#rmp, #gallery, #rmg, #palette-and-templates"})]})]})]}),e.jsx(Ce,{as:"h5",size:"sm",mt:3,mb:2,children:n("header.donation.title")}),e.jsxs(Ne,{children:[e.jsxs(ne,{size:"lg",w:"85%",onClick:()=>window.open("https://afdian.com/a/rail-map-toolkit","_blank"),cursor:"pointer",children:[e.jsx(re,{src:wn,size:"lg",my:2,ml:-1,mr:2}),e.jsxs(oe,{display:"block",width:"100%",pb:1,children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:n("header.donation.afdian")}),e.jsx(w,{fontSize:"sm",children:n("header.donation.viaCNY")})]})]}),e.jsxs(ne,{size:"lg",w:"85%",onClick:()=>window.open("https://opencollective.com/rail-map-toolkit","_blank"),cursor:"pointer",children:[e.jsx(re,{src:yn,size:"lg",my:2,ml:-1,mr:2}),e.jsxs(oe,{display:"block",width:"100%",pb:1,children:[e.jsx(w,{fontSize:"lg",fontWeight:"bold",mb:1,children:n("header.donation.openCollective")}),e.jsx(w,{fontSize:"sm",children:n("header.donation.viaUSD")})]})]})]})]})]})]})};/*!
 * canvas-size
 * v2.0.0
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2024 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function He(s){const a=s.sizes.shift(),i=Math.max(Math.ceil(a[0]),1),n=Math.max(Math.ceil(a[1]),1),o=[i-1,n-1,1,1],t=performance.now(),r=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope;let h,g;r?(h=new OffscreenCanvas(1,1),g=new OffscreenCanvas(i,n)):(h=document.createElement("canvas"),h.width=1,h.height=1,g=document.createElement("canvas"),g.width=i,g.height=n);const f=h.getContext("2d"),d=g.getContext("2d");d&&(d.fillRect.apply(d,o),f.drawImage(g,i-1,n-1,1,1,0,0,1,1));const m=f&&f.getImageData(0,0,1,1).data[3]!==0,l=parseInt(performance.now()-t);return[h,g].forEach(u=>{u.height=0,u.width=0}),r?(postMessage({width:i,height:n,testTime:l,isTestPass:m}),!m&&s.sizes.length&&setTimeout(()=>{He(s)},0)):m?s.onSuccess({width:i,height:n,testTime:l}):(s.onError({width:i,height:n,testTime:l}),s.sizes.length&&setTimeout(()=>{He(s)},0)),m}const ns={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},ve={max:null,min:1,sizes:[],step:1024,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},Ee={};function rs(s){const a=s.width===s.height,i=s.height===1,n=s.width===1,o=[];if(!s.width||!s.height)s.sizes.forEach(t=>{const r=a||i?t:1,h=a||n?t:1;o.push([r,h])});else{const t=s.min||ve.min,r=s.step||ve.step;let h=Math.max(s.width,s.height);for(;h>=t;){const g=a||i?h:1,f=a||n?h:1;o.push([g,f]),h-=r}}return o}function Ve(s){const a=typeof window<"u",i=a&&"Promise"in window,n=a&&"HTMLCanvasElement"in window,o=a&&"OffscreenCanvas"in window,t=URL.createObjectURL(new Blob([])).slice(-36),r=performance.now(),{onError:h,onSuccess:g,...f}=s,d=()=>parseInt(performance.now()-r);let m=null;if(!n)return!1;if(s.useWorker&&o){const l="\n            var canvasTest = ".concat(He.toString(),";\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        "),u=new Blob([l],{type:"application/javascript"}),c=URL.createObjectURL(u);m=new Worker(c),URL.revokeObjectURL(c),m.onmessage=function(p){const{width:x,height:j,testTime:S,isTestPass:y}=p.data,M={width:x,height:j,testTime:S,totalTime:d()};y?(Ee[t].onSuccess(M),delete Ee[t]):Ee[t].onError(M)}}if(i)return new Promise(l=>{const u={...s,onError(c){let{width:p,height:x,testTime:j}=c;const S={width:p,height:x,testTime:j,totalTime:d()};let y;if(s.sizes.length===0)y=!0;else{const[[M,H]]=s.sizes.slice(-1);y=p===M&&x===H}h(S),y&&l({...S,success:!1})},onSuccess(c){let{width:p,height:x,testTime:j}=c;const S={width:p,height:x,testTime:j,totalTime:d()};g(S),l({...S,success:!0})}};if(m){const{onError:c,onSuccess:p}=u;Ee[t]={onError:c,onSuccess:p},m.postMessage(f)}else He(u)});if(m)Ee[t]={onError:h,onSuccess:g},m.postMessage(f);else return He(s)}const vn={maxArea(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a=rs({width:s.max,height:s.max,min:s.min,step:s.step,sizes:[...ns.area]}),i={...ve,...s,sizes:a};return Ve(i)},maxHeight(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a=rs({width:1,height:s.max,min:s.min,step:s.step,sizes:[...ns.height]}),i={...ve,...s,sizes:a};return Ve(i)},maxWidth(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a=rs({width:s.max,height:1,min:s.min,step:s.step,sizes:[...ns.width]}),i={...ve,...s,sizes:a};return Ve(i)},test(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const a={...ve,...s};return a.sizes=[...a.sizes],a.width&&a.height&&(a.sizes=[[a.width,a.height]]),Ve(a)}};var We=(s=>(s.left="l",s.right="r",s))(We||{}),be=(s=>(s.through="through",s.nonThrough="nonthrough",s))(be||{}),Fe=(s=>(s.local="local",s.express="express",s.direct="direct",s))(Fe||{}),ge=(s=>(s.MTR="mtr",s.GZMTR="gzmtr",s.SHMetro="shmetro",s))(ge||{}),Cs=(s=>(s.sh="sh",s.sh2020="sh2020",s))(Cs||{});const de=new Set,hs=new Set,us=new Set,ps=new Set,gs=new Map,me=new Map,os=new Set,is=new Map,Z=new Map;let _=[],_e=0;const Ke=new Map,as=new Map,ms=new Set,kn={localisedName:{en:"LEFT END"},num:"00",services:[Fe.local],parents:[],children:["lineend"],transfer:{groups:[{}],tick_direc:We.right,paid_area:!0},loop_pivot:!1,one_line:!0,int_padding:355},On={localisedName:{en:"RIGHT END"},num:"00",services:[Fe.local],parents:[],children:[],transfer:{groups:[{}],tick_direc:We.right,paid_area:!0},loop_pivot:!1,one_line:!0,int_padding:355},Mn={},$s={svgWidth:{destination:1500,runin:1500,railmap:1500,indoor:1500},svg_height:400,style:ge.SHMetro,y_pc:50,padding:10,branchSpacingPct:33,direction:We.right,platform_num:"1",theme:[wt.Shanghai,"sh1","#E3002B",ws.white],line_name:["地鐵線","Metro Line"],current_stn_idx:"jlaMj2",stn_list:Mn,namePosMTR:{isStagger:!0,isFlip:!0},customiseMTRDest:{isLegacy:!1,terminal:!1},line_num:"1",psd_num:"1",info_panel_type:Cs.sh,direction_gz_x:40,direction_gz_y:70,coline:{},loop:!1,loop_info:{bank:!0,left_and_right_factor:0,bottom_factor:1}},An={localisedName:{},num:"",services:[Fe.local],parents:[],children:[],transfer:{groups:[{}],tick_direc:We.right,paid_area:!0},loop_pivot:!1,one_line:!0,int_padding:355},z=s=>"".concat(s[0],"/").concat(s[1],"=").concat(s[2]).concat(s[3]),zs=s=>Js.includes(s),Tn=s=>{if(zs(s.style))return structuredClone(s[s.style].color)},Rn=(s,a)=>{const[i,n]=s.extremities(a),o=s.getEdgeAttributes(a),t=o.style;if(i!=n&&zs(t)){const r=Tn(o);ps.has(z(r))||(us.add(r),ps.add(z(r)),gs.set(r,i),me.set(z(r),new Set)),me.get(z(r)).add(i),me.get(z(r)).add(n),Z.has(i)?_.push({target:n,next:Z.get(i),color:r}):_.push({target:n,next:-1,color:r}),Z.set(i,_e),_e++,Z.has(n)?_.push({target:i,next:Z.get(n),color:r}):_.push({target:i,next:-1,color:r}),Z.set(n,_e),_e++}},et=(s,a,i)=>{if(me.get(z(i)).has(s)){me.get(z(i)).delete(s);for(let n=Z.get(s);n!=-1;n=_[n].next){const o=_[n].target,t=_[n].color;z(t)==z(i)&&et(o,s,i)}}},st=(s,a,i)=>{if(de.has(s))return;de.add(s);let n=0;const o=new Set;for(let t=Z.get(s);t!=-1;t=_[t].next){const r=_[t].target,h=_[t].color;z(h)==z(i)&&(o.has(r)||(o.add(r),n++,r!=a&&st(r,s,i)))}Ke.set(s,n)},Ls=(s,a)=>{const i=s.stn_list.lineend.parents;i.push(a),s.stn_list.lineend.parents=structuredClone(i).reverse(),s.stn_list.lineend.branch={...s.stn_list.lineend.branch,left:s.stn_list.lineend.parents.length==2?[be.through,i[1]]:void 0}},En=(s,a)=>{let i=0;for(let n=Z.get(s);n!=-1;n=_[n].next){_[n].target;const o=_[n].color;z(o)==z(a)&&i++}return i},tt=(s,a,i)=>{if(ms.has(s))return[];ms.add(s);const n=[];for(let o=Z.get(s);o!=-1;o=_[o].next){const t=_[o].target,r=_[o].color;t!=a&&z(r)==z(i)&&(t.startsWith("stn")?n.push(t):n.push(...tt(t,s,i)))}return n},xs=(s,a,i,n,o,t,r)=>{var l;if(de.has(s)&&(!s.startsWith("misc_node_")&&r.stn_list[s]==null||s.startsWith("misc_node_")&&!hs.has(s)||r.loop))return[];if(de.has(s)&&r.stn_list[s]!=null&&En(s,t)-1>=2){const u=[...r.stn_list[s].parents,a];if(r.stn_list[u[1]]==null){const x=u[0];u[0]=u[1],u[1]=x}r.stn_list[s].parents=structuredClone(u).reverse(),r.stn_list[s].branch={...r.stn_list[s].branch,left:[be.through,u[1]]};const c=[];for(const x of r.stn_list[s].children)x!=a&&c.push(x);r.stn_list[s].children=structuredClone(c),(l=r.stn_list[s].branch)==null||delete l.right;const p=[];for(const x of r.stn_list.lineend.parents)x!=s&&p.push(x);return r.stn_list.lineend.parents=structuredClone(p).reverse(),r.stn_list.lineend.branch={...r.stn_list.lineend.branch,left:r.stn_list.lineend.parents.length==2?[be.through,p[1]]:void 0},c.length==0&&(r.stn_list[s].children=["lineend"],Ls(r,s)),[s]}de.add(s);const h=[],g=[],f=[],d=new Set,m=new Set;for(let u=Z.get(s);u!=-1;u=_[u].next){const c=_[u].target,p=_[u].color;if(c!=i){if(z(p)==z(t)){if(m.has(c))continue;if(m.add(c),s.startsWith("misc_node_")){const x=xs(c,a,s,n+1,o,t,r);x.length!=0&&h.push(...x)}else{const x=xs(c,s,s,n+1,o,t,r);x.length!=0&&h.push(...x)}}if(!d.has(z(p))&&z(p)!=z(t)){d.add(z(p));const x={theme:p,name:["ch_".concat(z(p)),"en_".concat(z(p))]};f.push(x)}}}if(h.length==2){for(let u=0;u<2;u++)h[u]=="lineend"&&h.splice(u,1);if(r.stn_list[h[1]].parents.length>=2){const u=h[0];h[0]=h[1],h[1]=u}}if(de.has(s)&&r.stn_list[s]!=null){const u=[];for(const c of r.stn_list.lineend.parents)c!=s&&u.push(c);r.stn_list.lineend.parents=structuredClone(u).reverse(),r.stn_list.lineend.branch={...r.stn_list.lineend.branch,left:r.stn_list.lineend.parents.length==2?[be.through,u[1]]:void 0},h.length==0&&(ms.clear(),g.push(...tt(s,a,t)))}if(s.startsWith("misc_node_"))return hs.add(s),h;{const u=o.getNodeAttributes(s).type,c=o.getNodeAttributes(s)[u];if(r.stn_list[s]=structuredClone(An),r.stn_list[s].localisedName={zh:c.names[0],en:c.names[1]},r.stn_list[s].num=String(n),o.getNodeAttributes(s).type==I.GzmtrBasic){const p=c;r.stn_list[s].num=p.stationCode,(p.secondaryNames[0]!==""||p.secondaryNames[1]!=="")&&(r.stn_list[s].localisedSecondaryName={zh:p.secondaryNames[0],en:p.secondaryNames[1]})}if(o.getNodeAttributes(s).type==I.GzmtrInt){const p=c,x=p.transfer[0];for(const j of x)if(z(j)==z(t)){r.stn_list[s].num=String(j[5]);break}(p.secondaryNames[0]!==""||p.secondaryNames[1]!=="")&&(r.stn_list[s].localisedSecondaryName={zh:p.secondaryNames[0],en:p.secondaryNames[1]})}return h.length!=0?(r.stn_list[s].children=structuredClone(h).reverse(),h.length==2&&(r.stn_list[s].branch={...r.stn_list[s].branch,right:[be.through,h[1]]})):(r.stn_list[s].children=["lineend"],Ls(r,s)),g.push(a),r.stn_list[s].parents=structuredClone(g).reverse(),g.length==2&&(r.stn_list[s].branch={...r.stn_list[s].branch,left:[be.through,g[1]]}),f.length!=0&&(r.stn_list[s].transfer.groups[0].lines=structuredClone(f)),[s]}},Nn=(s,a,i,n)=>{const o=structuredClone($s);n=="LOOP"&&(o.loop=!0);let t;switch(s.getNodeAttributes(i).type){case I.GzmtrBasic:case I.GzmtrInt:t=ge.GZMTR;break;case I.MTR:t=ge.MTR;break;default:t=ge.SHMetro;break}o.theme=structuredClone(a),o.style=t,o.stn_list.linestart=structuredClone(kn),o.stn_list.lineend=structuredClone(On),de.clear(),hs.clear();const r=xs(i,"linestart","linestart",1,s,a,o);if(o.current_stn_idx=r[0],o.stn_list.linestart.children=[r[0]],!(Object.keys(o.stn_list).length<=3||o.stn_list.lineend.parents.length>=3))return structuredClone(o)},_n=s=>{var n,o;de.clear(),us.clear(),ps.clear(),gs.clear(),me.clear(),os.clear(),is.clear(),Z.clear(),_=[],_e=0,Ke.clear(),as.clear(),s.filterEdges(t=>t.startsWith("line")).forEach(t=>{zs(s.getEdgeAttributes(t).style)&&Rn(s,t)});let a=0;s.forEachNode(t=>{as.set(t,++a)}),as.set("lineend",++a);const i=[];for(const t of us){let r=0;for(;me.get(z(t)).size!=0;){let h="line_root";me.get(z(t)).forEach(f=>{h=="line_root"&&(h=f)}),et(h,"line_root",t);const g={theme:t,index:++r};os.add(g),is.set(g,h)}}for(const t of os){const{theme:r}=t;de.clear(),Ke.clear(),st(is.get(t),"line_root",r);let h=!0,g="LINE";const f=[];for(const[m,l]of Ke)l==1&&f.push(m),l==3&&(g="BRANCH"),l>3&&(h=!1);if(!h)continue;f.length==0&&(g="LOOP",f.push(gs.get(r)));const d=[];for(const m of f){const l=Nn(s,r,m,g);l!=null&&d.push([l,(n=l.stn_list[l.current_stn_idx].localisedName.zh)!=null?n:"",(o=l.stn_list[l.current_stn_idx].localisedName.en)!=null?o:""])}d.length!=0&&i.push({id:ls(10),theme:r,param:structuredClone(d),type:g})}return i},In=s=>s[0]!=""&&s[1]!=""?s[0]+"_"+s[1]:s[0]!=""?s[0]:s[1]!=""?s[1]:"".concat(new Date().valueOf()),Hn=(s,a)=>{let i=s;return a.forEach((n,o)=>{const t=new RegExp("ch_".concat(o),"g"),r=new RegExp("en_".concat(o),"g");i=i.replace(t,n[0]),i=i.replace(r,n[1])}),i},Wn=(s,a,i,n)=>{s.line_name=a,s.line_num=String(i),ds("RMG_".concat(In(a),".json"),"application/json",Hn(JSON.stringify(s),n))},Ln={LINE:"#33ccff",BRANCH:"#007B61",LOOP:"#ff6666"},Bn=s=>{const{isOpen:a,onClose:i}=s,{t:n}=L(),o=b.useRef(window.graph),[t,r]=b.useState(!1),[h,g]=b.useState([[$s,"",""]]),[f,d]=b.useState(["","",""]),[m,l]=b.useState(new Map),[u,c]=b.useState(new Map),[p,x]=b.useState([]);b.useEffect(()=>{if(a){const S=_n(o.current),y=new Map;S.forEach(({id:M,theme:H})=>{y.set(z(H),M)}),x(S),l(y)}},[a]);const j=(S,y)=>document.getElementById("2RMG_"+y+"_"+S).value.trim();return e.jsxs(Y,{isOpen:a,onClose:i,size:"2xl",scrollBehavior:"inside",children:[e.jsx(F,{}),e.jsxs(J,{children:[e.jsx(q,{children:e.jsx(w,{as:"b",fontSize:"xl",children:n("header.download.2rmg.title")})}),e.jsx(X,{}),e.jsxs(Q,{children:[e.jsx(w,{fontSize:"sm",mt:"3",lineHeight:"100%",children:n("header.download.2rmg.info1")}),e.jsx(w,{fontSize:"sm",mt:"3",lineHeight:"100%",children:n("header.download.2rmg.info2")}),e.jsx("br",{}),p.length===0?e.jsx(w,{fontSize:"md",children:n("header.download.2rmg.noline")}):e.jsx("table",{children:e.jsx("tbody",{children:p.map(({id:S,theme:y,param:M,type:H})=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(Ts,{name:y[0]=="other"&&y[1]=="other"?y[2]:y[1],bg:y[2],fg:y[3]})}),e.jsx("td",{children:e.jsx($e,{placeholder:n("header.download.2rmg.placeholder.chinese"),id:"2RMG_nameCh_".concat(S),size:"sm"})}),e.jsx("td",{children:e.jsx($e,{placeholder:n("header.download.2rmg.placeholder.english"),id:"2RMG_nameEn_".concat(S),size:"sm"})}),e.jsx("td",{children:e.jsx($e,{placeholder:n("header.download.2rmg.placeholder.lineCode"),id:"2RMG_lineNum_".concat(S),size:"sm"})}),e.jsx("td",{children:e.jsx(Ts,{name:n("header.download.2rmg.type.".concat(H.toLowerCase())),bg:Ln[H],fg:ws.white})}),e.jsx("td",{children:e.jsx(R,{colorScheme:"blue",variant:"ghost",mr:"1",onClick:()=>{const G=j(S,"nameCh"),te=j(S,"nameEn"),he=j(S,"lineNum"),U=new Map;m.forEach(($,ue)=>{U.set(ue,[j($,"nameCh"),j($,"nameEn")])}),g(M),d([G,te,he]),c(U),r(!0)},size:"sm",children:e.jsx(qs,{})})})]},JSON.stringify(y)))})})]}),e.jsx(xe,{children:e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:i,children:n("close")})})]}),e.jsx(Pn,{isOpen:t,onClose:()=>r(!1),param:h,nameList:f,interchangeName:u})]})},Pn=s=>{const{isOpen:a,onClose:i,param:n,nameList:o,interchangeName:t}=s,{t:r}=L(),[h,g]=b.useState("");return b.useEffect(()=>{o[0]!=""&&o[1]!=""?g(o[0]+"/"+o[1]):o[0]!=""?g(o[0]):o[1]!=""?g(o[1]):g("")},[...o]),e.jsxs(Y,{isOpen:a,onClose:i,size:"md",scrollBehavior:"inside",children:[e.jsx(F,{}),e.jsxs(J,{children:[e.jsx(q,{children:e.jsxs(w,{as:"b",fontSize:"xl",children:[r("header.download.2rmg.download")," ",h]})}),e.jsx(X,{}),e.jsx(Q,{children:e.jsxs(lt,{children:[e.jsx(w,{fontSize:"sm",mb:"2",lineHeight:"100%",children:r("header.download.2rmg.downloadInfo")}),n.map(([f,d,m])=>e.jsxs(R,{onClick:()=>{Wn(f,[o[0],o[1]],o[2],t)},overflow:"hidden",size:"md",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"ruby",children:[d.replaceAll("\n","⏎"),"/",m.replaceAll("\n","⏎")]},"".concat(d).concat(m)))]})}),e.jsx(xe,{children:e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:i,children:r("close")})})]})]})},Gn=s=>{const{isOpen:a,onClose:i}=s,{t:n}=L();return e.jsxs(Y,{isOpen:a,onClose:i,size:"xl",scrollBehavior:"inside",children:[e.jsx(F,{}),e.jsxs(J,{children:[e.jsx(q,{children:n("header.download.termsAndConditions")}),e.jsx(X,{}),e.jsx(Q,{children:e.jsxs(ct,{children:[e.jsxs(ye,{children:["The layout of the elements on the signage or rail map, is designed by"," ",e.jsxs(O,{color:"teal.500",href:"https://www.shmetro.com/",isExternal:!0,children:["Shanghai Shentong Metro Group ",e.jsx(N,{as:T})]}),", ",e.jsxs(O,{color:"teal.500",href:"https://www.gzmtr.com/",isExternal:!0,children:["Guangzhou Metro Group ",e.jsx(N,{as:T})]})," or ",e.jsxs(O,{color:"teal.500",href:"https://www.mtr.com.hk/",isExternal:!0,children:["MTR Corporation ",e.jsx(N,{as:T})]}),", depending on your selection. You shall grant appropriate permit or license from the relevant company above before using the generated images for commercial purposes, if it is required to do so.",e.jsx("br",{}),"标志版或路线图的元素或布局，基于你所选择的风格，为",e.jsxs(O,{color:"teal.500",href:"https://www.shmetro.com/",isExternal:!0,children:["上海申通地铁集团 ",e.jsx(N,{as:T})]}),"，",e.jsxs(O,{color:"teal.500",href:"https://www.gzmtr.com/",isExternal:!0,children:["广州地铁集团公司 ",e.jsx(N,{as:T})]}),"或",e.jsxs(O,{color:"teal.500",href:"https://www.mtr.com.hk/",isExternal:!0,children:["港铁公司 ",e.jsx(N,{as:T})]}),"所设计。在产生的图像用作商业用途前，你应向相关公司取得适当之许可证或授权。"]}),e.jsxs(ye,{children:["The elements including shapes and lines on the image are drawn by"," ",e.jsxs(O,{color:"teal.500",href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",e.jsx(N,{as:T})]})," and ",e.jsxs(O,{color:"teal.500",href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",e.jsx(N,{as:T})]}),", based on the design standards or rules of the companies listed above. You may use them for any purposes, but it is recommended to state the name and the link of software alongside.",e.jsx("br",{}),"图像的元素，包括图形及线条，均由",e.jsxs(O,{color:"teal.500",href:"https://www.github.com/thekingofcity",isExternal:!0,children:["thekingofcity ",e.jsx(N,{as:T})]}),"及",e.jsxs(O,{color:"teal.500",href:"https://www.github.com/wongchito",isExternal:!0,children:["Chito Wong ",e.jsx(N,{as:T})]}),"基于上述公司设计标准或准则绘制。你可将其用于任何目的，但我们建议你于使用同时附以我们的名字以及本网站地址。"]}),e.jsxs(ye,{children:["Due to copyright, licensing and other legal restrictions, Rail Map Painter uses"," ",e.jsxs(O,{color:"teal.500",href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["GenYoMin provided by ButTaiwan ",e.jsx(N,{as:T})]}),", and Vegur instead of MTRSung and Myriad Pro respectively to display and generate MTR-style signage. You shall grant appropriate permit or license from the manufacturers before using those generated images for commercial purposes.",e.jsx("br",{}),"由于著作权及其他法律限制，铁路路线图绘制器使用由",e.jsxs(O,{color:"teal.500",href:"https://github.com/ButTaiwan/genyo-font",isExternal:!0,children:["ButTaiwan提供的源樣明體 ",e.jsx(N,{as:T})]}),"，以及Vegur，以代替港铁样式标志牌所使用的地铁宋及Myriad Pro。在产生之图像用作商业用途前，你应向字型生产厂商取得适当之许可证或授权。"]}),e.jsxs(ye,{children:["The exported images in PNG or SVG format may be modified, published, or used for other purposes except commercial use, under the conditions above.",e.jsx("br",{}),"输出的PNG或SVG图像可基于上述条款，在非商业使用时，用于修改、发行或其他用途。"]}),e.jsxs(ye,{children:["All flag emojis shown on Windows platforms are designed by"," ",e.jsxs(O,{color:"teal.500",href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",e.jsx(N,{as:T})]})," ","– the open-source emoji and icon project. License:",e.jsxs(O,{color:"teal.500",href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",e.jsx(N,{as:T})]}),e.jsx("br",{}),"于Windows作业系统上显示的国旗Emoji为",e.jsxs(O,{color:"teal.500",href:"https://openmoji.org/",isExternal:!0,children:["OpenMoji ",e.jsx(N,{as:T})]}),"所设计。许可证：",e.jsxs(O,{color:"teal.500",href:"https://creativecommons.org/licenses/by-sa/4.0/",isExternal:!0,children:["CC BY-SA 4.0 ",e.jsx(N,{as:T})]})]}),e.jsxs(ye,{children:["We reserve the rights, without prior notice, to modify, add, or remove these terms. The Chinese translation is for reference only. In case of any discrepancy between the English version and the Chinese version, the English version shall prevail.",e.jsx("br",{}),"我们保留修改、新增或移除上述条款之权利，而无需另行通知。中文译本仅供参考，文义如与英文有歧异，概以英文本为准。"]})]})})]})]})};function Dn(){const s=Ds("white","var(--chakra-colors-gray-800)"),a=P(),{telemetry:{project:i}}=B(v=>v.app),n=B(v=>v.param),o=E.isAllowAnalytics(),{t}=L(),r=b.useRef(window.graph),[h,g]=b.useState("png"),f={png:t("header.download.png"),svg:t("header.download.svg")},[d,m]=b.useState(2),[l,u]=b.useState({width:1,height:1,benchmark:.001}),[c,p]=b.useState(200),x=[10,25,33,50,67,75,100,125,150,175,200,250,300,400,500,750,1e3],j=Object.fromEntries(x.map(v=>[v,"".concat(v,"%")])),[S,y]=b.useState([]),[M,H]=b.useState(!1),G=[{type:"select",label:t("header.download.format"),value:h,options:f,onChange:v=>g(v==="png"?"png":"svg")}],te=[{type:"select",label:t("header.download.svgVersion"),value:d,options:{1.1:t("header.download.svg1.1"),2:t("header.download.svg2")},onChange:v=>{m(v),v===1.1&&Ae(!0)}}],he=[{type:"select",label:t("header.download.scale"),value:c,options:j,disabledOptions:S,onChange:v=>p(v)},{type:"switch",label:t("header.download.transparent"),isChecked:M,onChange:H}],[U,$]=b.useState(!1),[ue,Le]=b.useState(!1),[Be,Ae]=b.useState(!1),[Pe,W]=b.useState(!1),[vs,nt]=b.useState(!1),[rt,ks]=b.useState(!1);b.useEffect(()=>{(async()=>{const Te=await vn.maxArea({usePromise:!0,useWorker:!0});u(Te)})()},[]),b.useEffect(()=>{if(U){const{xMin:v,yMin:Te,xMax:Je,yMax:Ge}=St(r.current),[qe,we]=[Je-v,Ge-Te],Re=x.filter(Se=>qe*Se/100>l.width&&we*Se/100>l.height);y(Re)}},[U]);const ot=()=>{o&&E.event(Me.DOWNLOAD_PARAM,i?{"#nodes":r.current.order,"#edges":r.current.size}:{}),ds("RMP_".concat(new Date().valueOf(),".json"),"application/json",vt(n))},it=async()=>{$(!1),o&&E.event(Me.DOWNLOAD_IMAGES,i?{numberOfNodes:r.current.order,numberOfEdges:r.current.size}:{});const{elem:v,width:Te,height:Je}=await pn(r.current,Pe,Be,d),Ge=v.outerHTML.replace(/&nbsp;/g," ");if(h==="svg"){ds("RMP_".concat(new Date().valueOf(),".svg"),"image/svg+xml",Ge);return}document.body.appendChild(v);const qe="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(Ge)));document.body.removeChild(v),v.remove();const we=document.createElement("canvas"),[Re,Se]=[Te*c/100,Je*c/100];we.width=Re,we.height=Se;const Xe=we.getContext("2d");M||(Xe.fillStyle=s,Xe.fillRect(0,0,Re,Se));const Qe=new Image;Qe.onload=()=>{setTimeout(()=>{Xe.drawImage(Qe,0,0,Re,Se),we.toBlob(Os=>{if(!Os){a(Ye({status:"error",message:t("header.download.imageTooBig")}));return}gn("RMP_".concat(new Date().valueOf(),".png"),Os)},"image/png")},mn()?2e3:0)},Qe.src=qe};return e.jsxs(fs,{id:"download",children:[e.jsx(js,{as:ee,size:"sm",variant:"ghost",icon:e.jsx(qs,{})}),e.jsxs(bs,{children:[e.jsx(ce,{icon:e.jsx(yt,{}),onClick:ot,children:t("header.download.config")}),e.jsxs(ce,{icon:e.jsx(Ct,{}),onClick:()=>ks(!0),children:[t("header.download.2rmg.title"),e.jsx(le,{ml:"1",colorScheme:"green",children:"New"})]}),e.jsx(ce,{icon:e.jsx(zt,{}),onClick:()=>$(!0),children:t("header.download.image")})]}),e.jsxs(Y,{size:"xl",isOpen:U,onClose:()=>$(!1),children:[e.jsx(F,{}),e.jsxs(J,{children:[e.jsx(q,{children:t("header.download.image")}),e.jsx(X,{}),e.jsxs(Q,{children:[e.jsx(ke,{fields:G}),h==="svg"&&e.jsx(ke,{fields:te}),h==="png"&&e.jsx(ke,{fields:he}),h==="png"&&S.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(w,{as:"i",fontSize:"sm",children:t("header.download.disabledScaleOptions")}),e.jsx("br",{}),e.jsx(w,{as:"i",fontSize:"sm",children:t("header.download.disabledScaleOptionsWorkarounds")}),e.jsxs(O,{color:"teal.500",onClick:()=>window.open("https://github.com/RazrFalcon/resvg","_blank"),children:["RazrFalcon/resvg ",e.jsx(N,{as:T})]}),e.jsx("br",{})]}),e.jsx("br",{}),e.jsx(es,{isChecked:Be,isDisabled:h==="svg"&&d===1.1,onChange:v=>Ae(v.target.checked),children:e.jsx(w,{children:t("header.download.useSystemFonts")})}),e.jsx(es,{isChecked:Pe,onChange:v=>W(v.target.checked),children:e.jsxs(w,{children:[t("header.download.shareInfo1"),e.jsxs(O,{color:"teal.500",onClick:()=>window.open("https://railmapgen.github.io/rmp","_blank"),children:[t("header.about.rmp")," ",e.jsx(N,{as:T})]}),t("header.download.shareInfo2")]})}),e.jsx(es,{isChecked:vs,onChange:v=>nt(v.target.checked),children:e.jsxs(w,{children:[t("header.download.termsAndConditionsInfo"),e.jsxs(O,{color:"teal.500",onClick:()=>Le(!0),children:[t("header.download.termsAndConditions")," ",e.jsx(N,{as:T})]}),t("header.download.period")]})})]}),e.jsx(xe,{children:e.jsx(dt,{children:e.jsx(R,{colorScheme:"teal",variant:"outline",size:"sm",isDisabled:!vs||h==="png"&&S.includes(c),onClick:it,children:t("header.download.confirm")})})}),e.jsx(Gn,{isOpen:ue,onClose:()=>Le(!1)})]})]}),e.jsx(Bn,{isOpen:rt,onClose:()=>ks(!1)})]})}const Un=(s,{info_panel_type:a,line_num:i,stn_list:n,style:o,theme:t},r,h,g)=>{const f=Object.fromEntries(Object.keys(n).filter(l=>!["linestart","lineend"].includes(l)).map(l=>[l,"stn_".concat(ls(10))]));Object.entries(n).filter(([l,u])=>!["linestart","lineend"].includes(l)).forEach(([l,u])=>{const c=s.filterNodes((p,x)=>Object.values(I).includes(x.type)&&x[x.type].names[0]===u.localisedName.zh);c.length!==0&&(f[l]=c[0])});const d=[["linestart",-1,0]],m={};for(;d.length;){const[l,u,c]=d.shift();n[l].children.filter(x=>x!="lineend").forEach((x,j)=>{const S=Math.max(j,c+j);m[x]={x:u*150,y:S*75},d.push([x,u+1,S])})}Object.entries(n).filter(([l,u])=>!["linestart","lineend"].includes(l)).filter(([l,u])=>s.filterNodes((c,p)=>Object.values(I).includes(p.type)&&p[p.type].names[0]===u.localisedName.zh).length===0).map(([l,u])=>{var S,y,M;let c=I.ShmetroBasic;const p=u.transfer.groups,x=p.map(H=>{var G;return(G=H.lines)!=null?G:[]}).flat();o===ge.SHMetro?x.length>0?c=I.ShmetroInt:a===Cs.sh2020?c=I.ShmetroBasic2020:c=I.ShmetroBasic:o===ge.GZMTR?x.length>0?c=I.GzmtrInt:c=I.GzmtrBasic:o===ge.MTR&&(c=I.MTR);const j={...structuredClone(xn[c].defaultAttrs),names:[(S=u.localisedName.zh)!=null?S:"",(y=u.localisedName.en)!=null?y:""]};return c===I.ShmetroBasic2020?j.color=t:c===I.GzmtrBasic?(j.color=t,j.lineCode=i,j.stationCode=u.num):c===I.GzmtrInt?j.transfer=p.map((H,G)=>{var he,U;const te=(U=(he=H.lines)==null?void 0:he.map($=>{var ue;return[...(ue=$.theme)!=null?ue:t,"1","01"]}))!=null?U:[];return G===0?[[...t,i,u.num],...te]:te}):c===I.MTR&&((M=p[0].lines)!=null&&M.length?j.transfer=[[[...t,"",""],...p[0].lines.map(H=>{var G;return[...(G=H.theme)!=null?G:t,"",""]})]]:j.transfer=[[]]),{node:f[l],attr:{visible:!0,zIndex:0,x:r+m[l].x,y:h+m[l].y,type:c,[c]:j}}}).forEach(({node:l,attr:u})=>s.addNode(l,u)),Object.entries(n).filter(([l,u])=>!["linestart","lineend"].includes(l)).forEach(([l,u])=>{u.children.filter(c=>!["linestart","lineend"].includes(c)).forEach(c=>{const p=ss.Diagonal,[x,j]=[f[l],f[c]],S=g?kt(s,p,x,j,"from"):-1;s.addDirectedEdgeWithKey("line_".concat(ls(10)),x,j,{visible:!0,zIndex:0,type:p,[ss.Diagonal]:structuredClone(Ot[ss.Diagonal].defaultAttrs),style:Rs.SingleColor,[Rs.SingleColor]:{color:t},reconcileId:"",parallelIndex:S})})})},Zn="rmg-bridge--",Vn={h:500,maxH:"70%","& iframe":{h:"100%",w:"100%"}};function Kn(s){const{isOpen:a,onClose:i}=s,{t:n}=L(),{preference:{autoParallel:o}}=B(j=>j.app),{svgViewBoxZoom:t,svgViewBoxMin:r}=B(j=>j.param),h=P(),g=E.isAllowAnalytics(),f=ys(),{height:d,width:m}=Ss(f),l=Ze.useRef(window.graph),[u]=Ze.useState(crypto.randomUUID()),c="/rmg/#/import?"+new URLSearchParams({parentComponent:E.getAppName(),parentId:u}),p=Ze.useCallback(()=>{h(K()),h(V()),h(se(l.current.export()))},[h,K,V,se,l]),x=j=>{try{g&&E.event(Me.IMPORT_RMG_PARAM,{});const S=r.x+m*t/100/3,y=r.y+d*t/100/3;Un(l.current,j,S,y,o),p()}catch(S){h(Ye({status:"error",message:n("header.open.unknownError")})),console.error("OpenActions.handleUploadRMG():: Unknown error occurred while parsing the RMG project",S)}finally{i()}};return Ze.useEffect(()=>{const j=new BroadcastChannel(Zn+u);return j.onmessage=S=>{const{event:y,data:M}=S.data;console.log("[rmp] Received event from RMG app clip:",y),y==="CLOSE"?i():y==="IMPORT"&&x(M)},()=>j.close()},[r.x,r.y,t,d,m,o]),e.jsx(Xs,{isOpen:a,onClose:i,sx:Vn,children:e.jsx("iframe",{src:c,loading:"lazy"})})}const Yn="RMP_GALLERY_CHANNEL",Fn="OPEN_TEMPLATE",Bs=new BroadcastChannel(Yn),Jn={h:"80%",w:"80%","& iframe":{h:"100%",w:"100%"},"& div":{h:"100%",w:"100%"}};function qn(s){const{isOpen:a,onClose:i}=s,n=Us(),{t:o}=L(),t=P(),{telemetry:{project:r}}=B(l=>l.app),h=E.isAllowAnalytics(),g=b.useRef(window.graph),f=b.useCallback(()=>{t(K()),t(V()),t(se(g.current.export()))},[t,K,V,se,g]),d=async l=>{const{version:u,...c}=JSON.parse(await Qs(JSON.stringify(l)));t(cs()),g.current.clear(),g.current.import(c.graph),f();const{svgViewBoxZoom:p,svgViewBoxMin:x}=c;typeof p=="number"&&t(Oe(p)),typeof x.x=="number"&&typeof x.y=="number"&&t(Ie(x))},m=async(l,u)=>{var x;const c=u?"https://".concat(u):"",p=await((x=(await Promise.allSettled([fetch("".concat(c,"/rmp-gallery/resources/real_world/").concat(l,".json")),fetch("".concat(c,"/rmp-gallery/resources/fantasy/").concat(l,".json"))])).filter(j=>j.status==="fulfilled").find(j=>j.value.status===200))==null?void 0:x.value.json());if(p){if(h){const j={id:l};r&&u&&(j.host=u),E.event(Me.IMPORT_WORK_FROM_GALLERY,j)}d(p),n({title:o("header.open.importFromRMPGallery",{id:l}),status:"success",duration:9e3,isClosable:!0})}else n({title:o("header.open.failToImportFromRMPGallery",{id:l}),status:"error",duration:9e3,isClosable:!0})};return b.useEffect(()=>{const u=new URL(window.location.href).searchParams;if(u.size>0){const c=u.keys().next().value,p=c.indexOf("."),x=c.substring(0,p===-1?void 0:p);let j;p!==-1&&(j=c.substring(p+1)),m(x,j)}},[]),b.useEffect(()=>(Bs.onmessage=l=>{const{event:u,data:c}=l.data;u===Fn&&(m(c),i())},()=>Bs.close()),[]),e.jsxs(Xs,{isOpen:a,onClose:i,size:"full",sx:Jn,children:[e.jsx("iframe",{src:"/rmp-gallery/",loading:"lazy"}),e.jsx(Zs,{onClick:i,position:"fixed",top:"5px",right:"15px"})]})}function Xn(){const s=P(),{t:a}=L(),i=ys(),{height:n}=Ss(i),o=b.useRef(window.graph),t=b.useRef(null),[r,h]=b.useState(!1),[g,f]=b.useState(!1),d=b.useCallback(()=>{s(K()),s(V()),s(se(o.current.export()))},[s,K,V,se,o]),m=()=>{s(cs()),o.current.clear(),s(Oe(100)),s(Ie({x:0,y:0})),d()},l=async p=>{const{version:x,...j}=JSON.parse(await Qs(p));s(cs()),o.current.clear(),o.current.import(j.graph),d();const{svgViewBoxZoom:S,svgViewBoxMin:y}=j;typeof S=="number"&&s(Oe(S)),typeof y.x=="number"&&typeof y.y=="number"&&s(Ie(y))},u=async p=>{var j;const x=(j=p.target.files)==null?void 0:j[0];if(console.log("OpenActions.handleUpload():: received file",x),(x==null?void 0:x.type)!=="application/json")s(Ye({status:"error",message:a("header.open.invalidType")})),console.error("OpenActions.handleUpload():: Invalid file type! Only file in JSON format is accepted.");else try{const S=await Qn(x);await l(S)}catch(S){s(Ye({status:"error",message:a("header.open.unknownError")})),console.error("OpenActions.handleUpload():: Unknown error occurred while parsing the uploaded file",S)}p.target.value=""},c=async()=>{await l(await Rt()),s(Ie({x:-10,y:-13}));const p=Math.max(0,Math.min(400,-.132*n+117.772));s(Oe(p)),E.event(Me.LOAD_TUTORIAL,{})};return b.useEffect(()=>{const p=async x=>{const{type:j,key:S,from:y}=x.data;if(j===Et.SAVE_CHANGED&&S===_s.PARAM&&y==="rmt"){Nt.debug("Received save changed event on key: ".concat(S));const M=localStorage.getItem(_s.PARAM);if(!M)return;await l(M)}};return Es.addEventListener("message",p),()=>Es.removeEventListener("message",p)},[]),e.jsxs(fs,{children:[e.jsx(js,{as:ee,size:"sm",variant:"ghost",icon:e.jsx(Ns,{})}),e.jsxs(bs,{children:[e.jsx(ce,{icon:e.jsx(Mt,{}),onClick:m,children:a("header.open.new")}),e.jsx("input",{id:"upload_project",ref:t,type:"file",accept:".json",hidden:!0,onChange:u,"data-testid":"file-upload"}),e.jsx(ce,{icon:e.jsx(Ns,{}),onClick:()=>{var p;return(p=t==null?void 0:t.current)==null?void 0:p.click()},children:a("header.open.config")}),e.jsx(ce,{icon:e.jsx(At,{}),onClick:()=>h(!0),children:a("header.open.projectRMG")}),e.jsxs(ce,{icon:e.jsx(T,{}),onClick:()=>f(!0),children:[a("header.open.gallery"),e.jsx(le,{ml:"1",colorScheme:"green",children:"New"})]}),e.jsx(ce,{icon:e.jsx(Tt,{}),onClick:c,children:a("header.open.tutorial")})]}),e.jsx(Kn,{isOpen:r,onClose:()=>h(!1)}),e.jsx(qn,{isOpen:g,onClose:()=>f(!1)})]})}const Qn=s=>new Promise(a=>{const i=new FileReader;i.onloadend=()=>a(i.result),i.readAsText(s)}),$n=()=>{const[s,a]=b.useState(!1),{t:i}=L(),n=P(),o=b.useRef(window.graph),t=ys(),{width:r,height:h}=Ss(t),[g,f]=b.useState([]);b.useEffect(()=>{s&&f(o.current.nodes().filter(m=>m.startsWith("stn")).map(m=>{const l=o.current.getNodeAttributes(m),u=l.type,c=l[u].names.join("/");return{id:m,value:c}}))},[s]);const d=m=>{n(Wt(new Set([m])));const l=Math.max(0,Math.min(400,-.132*h+117.772)),{x:u,y:c}=Lt((r-300)/2,h/2,l,{x:-o.current.getNodeAttribute(m,"x"),y:-o.current.getNodeAttribute(m,"y")});n(Oe(l)),n(Ie({x:-u,y:-c}))};return e.jsxs(Vs,{isOpen:s,onOpen:()=>a(!0),onClose:()=>a(!1),children:[e.jsx(Ks,{children:e.jsx(ee,{"aria-label":"zoom",variant:"ghost",size:"sm",icon:e.jsx(_t,{}),onClick:()=>a(!s)})}),e.jsx(Ys,{children:e.jsx(Fs,{children:e.jsx(It,{label:i("header.search"),children:e.jsx(Ht,{data:g,displayHandler:m=>e.jsx(le,{children:m.value}),filter:(m,l)=>l.value.toLowerCase().includes(m.toLowerCase())||Object.values(l.value).some(u=>u.toLowerCase().includes(m.toLowerCase())),value:"",onChange:m=>d(m.id)})})})})]})},er=s=>{const{isOpen:a,onClose:i}=s,n=P(),{theme:o,paletteAppClip:{output:t}}=B(u=>u.runtime),{t:r}=L(),h=b.useRef(window.graph),[g,f]=b.useState(o),[d,m]=b.useState(!1);b.useEffect(()=>{d&&t&&(f(t),m(!1))},[t==null?void 0:t.toString()]);const l=()=>{h.current.filterEdges((u,c,p,x,j,S,y)=>Js.includes(c.style)&&JSON.stringify(c[c.style].color)===JSON.stringify(g)).forEach(u=>h.current.dropEdge(u)),n(V()),n(se(h.current.export())),i()};return e.jsxs(Y,{isOpen:a,onClose:i,size:"xl",scrollBehavior:"inside",trapFocus:!1,children:[e.jsx(F,{}),e.jsxs(J,{children:[e.jsx(q,{children:r("header.settings.procedures.removeLines.title")}),e.jsx(X,{}),e.jsxs(Q,{children:[r("header.settings.procedures.removeLines.content"),e.jsx(Bt,{theme:g,onClick:()=>{m(!0),n(Pt(g))}})]}),e.jsxs(xe,{children:[e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:i,children:r("cancel")}),e.jsx(R,{colorScheme:"red",onClick:l,children:r("remove")})]})]})]})},sr=s=>{const{isOpen:a,onClose:i}=s,n=P(),{t:o}=L(),t=b.useRef(window.graph),[r,h]=b.useState(1),g=[{type:"input",label:o("header.settings.procedures.scale.factor"),value:r.toString(),variant:"number",onChange:d=>h(Number(d)),minW:"full"}],f=()=>{t.current.forEachNode((d,m)=>{t.current.updateNodeAttribute(d,"x",l=>(l!=null?l:0)*r),t.current.updateNodeAttribute(d,"y",l=>(l!=null?l:0)*r)}),n(K()),n(V()),n(se(t.current.export())),i()};return e.jsxs(Y,{isOpen:a,onClose:i,size:"xl",scrollBehavior:"inside",children:[e.jsx(F,{}),e.jsxs(J,{children:[e.jsx(q,{children:o("header.settings.procedures.scale.title")}),e.jsx(X,{}),e.jsxs(Q,{children:[o("header.settings.procedures.scale.content"),e.jsx(ke,{fields:g})]}),e.jsxs(xe,{children:[e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:i,children:o("cancel")}),e.jsx(R,{colorScheme:"red",onClick:f,children:o("apply")})]})]})]})},tr=s=>{const{isOpen:a,onClose:i}=s,n=P(),{t:o}=L(),t=b.useRef(window.graph),[r,h]=b.useState(0),[g,f]=b.useState(0),d=[{type:"input",label:o("header.settings.procedures.translate.x"),value:r.toString(),variant:"number",onChange:l=>h(Number(l)),minW:"full"},{type:"input",label:o("header.settings.procedures.translate.y"),value:g.toString(),variant:"number",onChange:l=>f(Number(l)),minW:"full"}],m=()=>{t.current.forEachNode((l,u)=>{t.current.updateNodeAttribute(l,"x",c=>(c!=null?c:0)+r),t.current.updateNodeAttribute(l,"y",c=>(c!=null?c:0)+g)}),n(K()),n(V()),n(se(t.current.export())),i()};return e.jsxs(Y,{isOpen:a,onClose:i,size:"xl",scrollBehavior:"inside",children:[e.jsx(F,{}),e.jsxs(J,{children:[e.jsx(q,{children:o("header.settings.procedures.translate.title")}),e.jsx(X,{}),e.jsxs(Q,{children:[o("header.settings.procedures.translate.content"),e.jsx(ke,{fields:d})]}),e.jsxs(xe,{children:[e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:i,children:o("cancel")}),e.jsx(R,{colorScheme:"red",onClick:m,children:o("apply")})]})]})]})},nr=s=>{const{isOpen:a,onClose:i}=s,n=P(),{preference:{unlockSimplePathAttempts:o}}=B(g=>g.app),{activeSubscriptions:t}=B(g=>g.account),{t:r}=L(),h=()=>{n(Gt(-1))};return e.jsxs(Y,{isOpen:a,onClose:i,size:"5xl",scrollBehavior:"inside",children:[e.jsx(F,{}),e.jsxs(J,{children:[e.jsx(q,{children:r("header.settings.procedures.unlockSimplePath.title")}),e.jsx(X,{}),e.jsxs(Q,{children:[e.jsx(w,{mb:"2",children:r("header.settings.procedures.unlockSimplePath.content1")}),e.jsx(w,{mb:"2",children:r("header.settings.procedures.unlockSimplePath.content2")}),e.jsx(w,{mb:"2",children:r("header.settings.procedures.unlockSimplePath.content3")})]}),e.jsx(xe,{children:e.jsx(ze,{label:r("header.settings.pro"),isOpen:!t.RMP_CLOUD&&o>=0,children:e.jsx(R,{onClick:h,isDisabled:!t.RMP_CLOUD||o<0,children:o>=0?r("header.settings.procedures.unlockSimplePath.check"):r("header.settings.procedures.unlockSimplePath.unlocked")})})})]})]})},rr=s=>{const{isOpen:a,onClose:i}=s,n=P(),o=Us(),{t}=L(),r=b.useRef(window.graph),[h,g]=b.useState(!1),f=async()=>{g(!0);const d=JSON.stringify(r.current.export());try{const m=await ar(d);r.current.clear(),r.current.import(m),n(K()),n(V()),n(se(r.current.export())),o({title:t("header.settings.procedures.updateColor.success"),status:"success",duration:9e3,isClosable:!0})}catch(m){console.error("[rmp] Error in updating all colors: ".concat(m)),o({title:t("header.settings.procedures.updateColor.error",{e:m}),status:"error",duration:9e3,isClosable:!0})}g(!1),i()};return e.jsxs(Y,{isOpen:a,onClose:i,size:"xl",scrollBehavior:"inside",children:[e.jsx(F,{}),e.jsxs(J,{children:[e.jsx(q,{children:t("header.settings.procedures.updateColor.title")}),e.jsx(X,{}),e.jsx(Q,{children:e.jsx(w,{children:t("header.settings.procedures.updateColor.content")})}),e.jsxs(xe,{children:[e.jsx(R,{colorScheme:"blue",variant:"outline",mr:"1",onClick:i,children:t("cancel")}),e.jsx(R,{colorScheme:"red",onClick:f,isLoading:h,children:t("apply")})]})]})]})},Ps=s=>s.length>=4&&s.every(a=>typeof a=="string")&&!!s[2].match(/^#[0-9a-fA-F]{6}$/)&&Object.values(ws).includes(s[3]),or=s=>{const a=[],i=(n,o)=>{if(Array.isArray(n)&&Ps(n)){a.push({path:o||"",value:n});return}for(const t in n){const r=n[t],h=o?"".concat(o,".").concat(t):t;Array.isArray(r)?Ps(r)?a.push({path:h,value:r}):r.forEach((g,f)=>i(g,"".concat(h,".").concat(f))):r&&typeof r=="object"&&i(r,h)}};return i(s),a},ir=(s,a,i)=>{const n=a.split(".");let o=s;for(let t=0;t<n.length-1;t++)o=o[n[t]];o[n[n.length-1]]=i},ar=async s=>{const a=JSON.parse(s),i=new Date().getTime(),n=or(a);console.log("[rmp] Found all themes pending for update",n);const o=1e4;let t,r=!1;const h=new Promise((g,f)=>{t=setTimeout(()=>{r=!0,f("Executing time exceeds ".concat(o,"ms"))},o),(async()=>{for(const{path:d,value:m}of n){if(r)throw new Error("Update aborted");const[l,u,c,p,...x]=m,j=await Dt([l,u,c,p]);ir(a,d,[...j,...x])}})().then(g).catch(f)});try{return await h,console.log("[rmp] Themes update completed, elapsed time ".concat((new Date().getTime()-i)/1e3," sec")),a}finally{clearTimeout(t)}},Gs=1,lr=()=>{const{state:s}=B(g=>g.account),{t:a}=L(),[i,n]=b.useState(!1),[o,t]=b.useState(Gs);b.useEffect(()=>{let g;return i&&o>0?g=window.setTimeout(()=>{t(o-1)},1e3):o===0&&n(!1),()=>clearTimeout(g)},[i,o]);const r=()=>{n(!0),t(Gs),Zt()},h={"logged-out":a("header.settings.subscription.logged-out"),free:a("header.settings.subscription.free"),subscriber:a("header.settings.subscription.subscriber"),expired:a("header.settings.subscription.expired")};return e.jsxs(A,{width:"100%",mb:"3",children:[e.jsx(w,{as:"b",fontSize:"xl",children:a("header.settings.subscription.title")}),e.jsx(A,{mt:"3",children:e.jsxs(A,{display:"flex",mb:"1",children:[e.jsx(w,{flex:"1",children:h[s]}),e.jsx(ee,{"aria-label":"refresh",variant:"ghost",size:"sm",icon:e.jsx(Ut,{}),isDisabled:i,onClick:()=>r()})]})})]})},je={width:"100%",justifyContent:"space-between"},ae={fontFamily:"-apple-system"},cr=s=>{const{isOpen:a,onClose:i}=s,{activeSubscriptions:n}=B(W=>W.account),{telemetry:{project:o},preference:{autoParallel:t,randomStationsNames:r}}=B(W=>W.app),{keepLastPath:h,parallelLinesCount:g}=B(W=>W.runtime),f=P(),{t:d}=L(),m=Ds("primary.500","primary.300"),[l,u]=b.useState(!1),[c,p]=b.useState(!1),[x,j]=b.useState(!1),[S,y]=b.useState(!1),[M,H]=b.useState(!1),[G,te]=b.useState(!1),[he,U]=b.useState(!1),$=E.isAllowAnalytics(),ue=W=>{f($t(W))},Le=n.RMP_CLOUD?Vt:Kt,Be=g>=Le,Ae=!n.RMP_CLOUD,Pe=W=>{f(en(W.target.value))};return e.jsxs(Y,{isOpen:a,onClose:i,size:"xl",scrollBehavior:"inside",trapFocus:!1,children:[e.jsx(F,{}),e.jsxs(J,{children:[e.jsx(q,{children:d("header.settings.title")}),e.jsx(X,{}),e.jsx(Q,{children:e.jsxs(Ne,{divider:e.jsx(ht,{borderColor:"gray.200"}),children:[e.jsx(lr,{}),e.jsxs(A,{width:"100%",mb:"3",children:[e.jsx(w,{as:"b",fontSize:"xl",children:d("header.settings.preference.title")}),e.jsxs(A,{mt:"3",children:[e.jsxs(A,{display:"flex",mb:"1",children:[e.jsx(w,{flex:"1",children:d("header.settings.preference.keepLastPath")}),e.jsx(De,{isChecked:h,onChange:({target:{checked:W}})=>f(Yt(W))})]}),e.jsxs(A,{display:"flex",mb:"1",children:[e.jsx(w,{children:d("header.settings.preference.autoParallel")}),e.jsx(le,{ml:"auto",colorScheme:"green",children:"New"}),e.jsx(ze,{label:d("header.settings.proWithTrial"),children:e.jsx(le,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",children:"PRO"})}),e.jsx(De,{ml:"1",isDisabled:Be,isChecked:t,onChange:({target:{checked:W}})=>f(Ft(W))})]}),e.jsxs(A,{mb:"1",display:"flex",children:[e.jsx(w,{flex:"1",children:d("header.settings.preference.randomStationNames.title")}),e.jsx(le,{ml:"auto",colorScheme:"green",children:"New"}),e.jsx(ze,{label:d("header.settings.pro"),children:e.jsx(le,{color:"gray.50",ml:"1",background:"radial-gradient(circle, #3f5efb, #fc466b)",children:"PRO"})}),e.jsxs(ut,{size:"xs",width:"auto",ml:"1",value:r,onChange:Pe,children:[e.jsx("option",{value:"none",children:d("header.settings.preference.randomStationNames.none")}),e.jsx("option",{value:Ue.Shmetro,disabled:Ae,children:d("header.settings.preference.randomStationNames.".concat(Ue.Shmetro))}),e.jsx("option",{value:Ue.Bjsubway,disabled:Ae,children:d("header.settings.preference.randomStationNames.".concat(Ue.Bjsubway))})]})]})]})]}),e.jsxs(A,{width:"100%",mb:"3",children:[e.jsx(w,{as:"b",fontSize:"xl",children:d("header.settings.procedures.title")}),e.jsxs(A,{mt:"3",children:[e.jsx(R,{sx:je,rightIcon:e.jsx(fe,{}),onClick:()=>u(!0),children:d("header.settings.procedures.translate.title")}),e.jsx(tr,{isOpen:l,onClose:()=>u(!1)}),e.jsx(R,{sx:je,rightIcon:e.jsx(fe,{}),onClick:()=>p(!0),children:d("header.settings.procedures.scale.title")}),e.jsx(sr,{isOpen:c,onClose:()=>p(!1)}),e.jsxs(R,{sx:je,rightIcon:e.jsx(fe,{}),onClick:()=>j(!0),children:[d("header.settings.procedures.changeType.title"),e.jsx(ze,{label:d("header.settings.pro"),children:e.jsx(le,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",mr:"auto",children:"PRO"})})]}),e.jsx(jn,{isOpen:x,onClose:()=>j(!1),isSelect:!1}),e.jsx(R,{sx:je,rightIcon:e.jsx(fe,{}),onClick:()=>y(!0),children:d("header.settings.procedures.removeLines.title")}),e.jsx(er,{isOpen:S,onClose:()=>y(!1)}),e.jsx(R,{sx:je,rightIcon:e.jsx(fe,{}),onClick:()=>H(!0),children:d("header.settings.procedures.updateColor.title")}),e.jsx(rr,{isOpen:M,onClose:()=>H(!1)}),e.jsxs(R,{sx:je,rightIcon:e.jsx(fe,{}),onClick:()=>te(!0),children:[d("header.settings.procedures.unlockSimplePath.title"),e.jsx(ze,{label:d("header.settings.pro"),children:e.jsx(le,{ml:"1",color:"gray.50",background:"radial-gradient(circle, #3f5efb, #fc466b)",mr:"auto",children:"PRO"})})]}),e.jsx(nr,{isOpen:G,onClose:()=>te(!1)}),e.jsx(R,{sx:je,rightIcon:e.jsx(fe,{}),onClick:()=>U(!0),children:d("header.settings.procedures.masterManager.title")}),e.jsx(fn,{isOpen:he,onClose:()=>U(!1)})]})]}),e.jsxs(A,{width:"100%",mb:"3",children:[e.jsx(w,{as:"b",fontSize:"xl",children:d("header.settings.shortcuts.title")}),e.jsx(A,{mt:"3",children:e.jsxs(pt,{children:[e.jsx(gt,{children:e.jsxs(D,{children:[e.jsx(As,{children:d("header.settings.shortcuts.keys")}),e.jsx(As,{children:d("header.settings.shortcuts.description")})]})}),e.jsxs(mt,{children:[e.jsxs(D,{children:[e.jsx(k,{children:e.jsx(C,{children:"f"})}),e.jsx(k,{children:d("header.settings.shortcuts.f")})]}),e.jsxs(D,{children:[e.jsx(k,{children:e.jsx(C,{children:"s"})}),e.jsx(k,{children:d("header.settings.shortcuts.s")})]}),e.jsxs(D,{children:[e.jsx(k,{children:e.jsxs(A,{display:"flex",flexDirection:"row",children:[e.jsx(Jt,{}),e.jsx(qt,{}),e.jsx(Xt,{}),e.jsx(Qt,{})]})}),e.jsx(k,{children:d("header.settings.shortcuts.arrows")})]}),e.jsxs(D,{children:[e.jsx(k,{children:e.jsxs(A,{display:"flex",flexDirection:"row",children:[e.jsx(C,{children:"i"}),e.jsx(C,{children:"j"}),e.jsx(C,{children:"k"}),e.jsx(C,{children:"l"})]})}),e.jsx(k,{children:d("header.settings.shortcuts.ijkl")})]}),e.jsxs(D,{children:[e.jsx(k,{children:pe?e.jsx(C,{sx:ae,children:"⇧"}):e.jsx(C,{children:"shift"})}),e.jsx(k,{children:d("header.settings.shortcuts.shift")})]}),e.jsxs(D,{children:[e.jsx(k,{children:pe?e.jsx(C,{sx:ae,children:"⌥"}):e.jsx(C,{children:"alt"})}),e.jsx(k,{children:d("header.settings.shortcuts.alt")})]}),e.jsxs(D,{children:[e.jsx(k,{children:pe?e.jsx(C,{sx:ae,children:"⌫"}):e.jsx(C,{children:"delete"})}),e.jsx(k,{children:d("header.settings.shortcuts.delete")})]}),e.jsxs(D,{children:[e.jsxs(k,{children:[pe?e.jsx(C,{sx:ae,children:"⌘"}):e.jsx(C,{children:"ctrl"})," + ",e.jsx(C,{children:"x"})]}),e.jsx(k,{children:d("header.settings.shortcuts.cut")})]}),e.jsxs(D,{children:[e.jsxs(k,{children:[pe?e.jsx(C,{sx:ae,children:"⌘"}):e.jsx(C,{children:"ctrl"})," + ",e.jsx(C,{children:"c"})]}),e.jsx(k,{children:d("header.settings.shortcuts.copy")})]}),e.jsxs(D,{children:[e.jsxs(k,{children:[pe?e.jsx(C,{sx:ae,children:"⌘"}):e.jsx(C,{children:"ctrl"})," + ",e.jsx(C,{children:"v"})]}),e.jsx(k,{children:d("header.settings.shortcuts.paste")})]}),e.jsxs(D,{children:[e.jsxs(k,{children:[pe?e.jsx(C,{sx:ae,children:"⌘"}):e.jsx(C,{children:"ctrl"})," + ",e.jsx(C,{children:"z"})]}),e.jsx(k,{children:d("header.settings.shortcuts.undo")})]}),e.jsxs(D,{children:[e.jsx(k,{children:pe?e.jsxs(e.Fragment,{children:[e.jsx(C,{sx:ae,children:"⇧"})," + ",e.jsx(C,{sx:ae,children:"⌘"})," + ",e.jsx(C,{children:"z"})]}):e.jsxs(e.Fragment,{children:[e.jsx(C,{children:"ctrl"})," + ",e.jsx(C,{children:"y"})]})}),e.jsx(k,{children:d("header.settings.shortcuts.redo")})]})]})]})})]}),e.jsxs(A,{width:"100%",mb:"3",children:[e.jsx(w,{as:"b",fontSize:"xl",children:d("header.settings.telemetry.title")}),e.jsxs(A,{mt:"3",children:[e.jsx(w,{fontSize:"sm",lineHeight:"100%",color:"gray.600",children:d("header.settings.telemetry.info")}),e.jsxs(A,{mt:"3",mb:"1",children:[e.jsxs(A,{display:"flex",mb:"1",children:[e.jsx(w,{flex:"1",children:d("header.settings.telemetry.essential")}),e.jsx(ze,{label:d("header.settings.telemetry.essentialTooltip"),children:e.jsx(De,{isChecked:$,isDisabled:!0})})]}),e.jsx(w,{fontSize:"sm",lineHeight:"100%",color:"gray.600",children:d("header.settings.telemetry.essentialInfo")}),e.jsxs(O,{color:m,fontSize:"sm",lineHeight:"100%",href:"https://support.google.com/analytics/answer/11593727",isExternal:!0,children:[d("header.settings.telemetry.essentialLink")," ",e.jsx(N,{as:T})]})]}),e.jsxs(A,{mt:"1",mb:"1",children:[e.jsxs(A,{display:"flex",children:[e.jsx(w,{flex:"1",children:d("header.settings.telemetry.additional")}),e.jsx(De,{isChecked:o,onChange:({target:{checked:W}})=>ue(W)})]}),e.jsx(w,{fontSize:"sm",lineHeight:"100%",color:"gray.600",children:d("header.settings.telemetry.additionalInfo")})]})]})]})]})})]})]})},dr=()=>{const[s,a]=b.useState(!1),{svgViewBoxZoom:i}=B(t=>t.param),n=P(),o=[{type:"slider",label:"",value:400-i,min:10,max:390,step:1,onChange:t=>n(Oe(400-t)),leftIcon:e.jsx(sn,{}),rightIcon:e.jsx(Is,{}),minW:160}];return e.jsxs(Vs,{isOpen:s,onOpen:()=>a(!0),onClose:()=>a(!1),children:[e.jsx(Ks,{children:e.jsx(ee,{"aria-label":"zoom",variant:"ghost",size:"sm",icon:e.jsx(Is,{}),onClick:()=>a(!s)})}),e.jsx(Ys,{children:e.jsx(Fs,{children:e.jsx(ke,{fields:o,noLabel:!0})})})]})};function hr(){const{t:s}=L(),a=P(),{past:i,future:n}=B(c=>c.param),o=E.isAllowAnalytics(),[t,r]=b.useState(!1),[h,g]=b.useState(!1),f=Ws(E.getEnv),d=Ws(E.getAppVersion);b.useEffect(()=>{o&&f!==ts.DEV&&E.event(Me.APP_LOAD,{isStandaloneWindow:E.isStandaloneWindow()})},[f]);const m=c=>{E.getI18nInstance().changeLanguage(c)},l=()=>{a(dn()),a(K()),a(V())},u=()=>{a(hn()),a(K()),a(V())};return e.jsxs(tn,{children:[e.jsx(Ce,{as:"h4",size:"md",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",children:s("header.about.rmp")}),e.jsx(nn,{environment:f,version:d,popoverHeader:f===ts.PRD?void 0:e.jsxs(Hs,{i18nKey:"header.popoverHeader",environment:f,children:["You're on ",{environment:f}," environment!"]}),popoverBody:f===ts.PRD?void 0:e.jsx(Hs,{i18nKey:"header.popoverBody",children:"This is a testing environment where we test the latest beta RMP."})}),e.jsxs(xt,{ml:"auto",children:[e.jsx(ie,{children:e.jsx($n,{})}),e.jsx(ie,{children:e.jsx(ee,{size:"sm",variant:"ghost","aria-label":"Undo",icon:e.jsx(rn,{}),isDisabled:i.length===0,onClick:l})}),e.jsx(ie,{children:e.jsx(ee,{size:"sm",variant:"ghost","aria-label":"Redo",icon:e.jsx(on,{}),isDisabled:n.length===0,onClick:u})}),e.jsx(ie,{children:e.jsx(dr,{})}),e.jsx(ie,{children:e.jsx(Xn,{})}),e.jsx(ie,{children:e.jsx(Dn,{})}),E.isStandaloneWindow()&&e.jsx(ie,{children:e.jsxs(fs,{children:[e.jsx(js,{as:ee,icon:e.jsx(an,{}),variant:"ghost",size:"sm"}),e.jsx(bs,{children:["en","zh-Hans","zh-Hant","ja","ko"].map(c=>e.jsx(ce,{onClick:()=>m(c),children:bn[c][c]},c))})]})}),e.jsx(ie,{children:e.jsx(ee,{size:"sm",variant:"ghost","aria-label":"Settings",icon:e.jsx(ln,{}),onClick:()=>r(!0)})}),e.jsx(ie,{children:e.jsx(ee,{size:"sm",variant:"ghost","aria-label":"Help",icon:e.jsx(cn,{}),onClick:()=>g(!0)})})]}),e.jsx(cr,{isOpen:t,onClose:()=>r(!1)}),e.jsx(zn,{isOpen:h,onClose:()=>g(!1)})]})}function ur(){const s=P(),a=B(n=>n.runtime.globalAlerts),i=n=>{E.isStandaloneWindow()?window.open("/".concat(n),"_blank"):E.openApp({appId:n})};return e.jsx(e.Fragment,{children:Object.entries(a).map(([n,{message:o,url:t,linkedApp:r}])=>e.jsxs(ft,{status:n,variant:"solid",size:"xs",pl:3,pr:1,py:0,zIndex:"1",children:[e.jsx(jt,{}),r?e.jsx(O,{onClick:()=>i(r),children:o}):t?e.jsx(O,{href:t,target:"_blank",children:o}):o,e.jsx(Zs,{ml:"auto",onClick:()=>s(un(n))})]},n))})}function jr(){return e.jsxs(e.Fragment,{children:[e.jsx(hr,{}),e.jsx(ur,{})]})}export{jr as default};
