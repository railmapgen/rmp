!function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?e(Object(s),!0).forEach((function(e){n(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):e(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function n(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}System.register(["./chakra-legacy-B5bKWenG.js","./index-legacy-BRImSNxH.js","./react-legacy-BoWZMSeR.js","./master-manager-legacy-DcIx5AfI.js"],(function(e,n){"use strict";var r,s,i,a,o,l,c,d,u,g,h,p,y,b,f,m,j,S,O,x,v,C,A,E,T,w,N,P,L,k,I,W,z,D,M,R,B,F,_,X,H;return{setters:[e=>{r=e.j,s=e.ag,i=e.M,a=e.ah,o=e.J,l=e.N,c=e.K,d=e.L,u=e.aG,g=e.aH,h=e.aI,p=e.B,y=e.aJ,b=e.aK,f=e.O,m=e.t,j=e.ax},e=>{S=e.L,O=e.S,x=e.aQ,v=e.ax,C=e.o,A=e.k,E=e.m,T=e.l,w=e.c,N=e.d,P=e.t,L=e.v,k=e.w,I=e.C,W=e.M,z=e.W,D=e.T,M=e.R,R=e.X,B=e.i},e=>{F=e.u,_=e.b},e=>{X=e.s,H=e.n}],execute:function(){const n=[O.ShmetroBasic2020,O.LondonTubeBasic,O.ShanghaiSuburbanRailway],J=e("b",((e,r,s)=>{const i=e.getNodeAttribute(r,"type"),a=structuredClone(e.getNodeAttribute(r,i).names);for(let t=0;t<Math.abs(X[s].defaultAttrs.names.length-a.length);t++)X[s].defaultAttrs.names.length>a.length?a.push("Stn"):a.pop();const o=t(t({},X[s].defaultAttrs),{},{names:a});Object.values(n).includes(i)&&Object.values(n).includes(s)||(o.nameOffsetX=e.getNodeAttribute(r,i).nameOffsetX,o.nameOffsetY=e.getNodeAttribute(r,i).nameOffsetY),x.includes(s)&&x.includes(i)&&(o.color=structuredClone(e.getNodeAttribute(r,i).color)),e.removeNodeAttribute(r,i),e.mergeNodeAttributes(r,{type:s,[s]:o})})),K=e("c",((e,t,n,r)=>{const s=e.getEdgeAttribute(t,"type"),i=e.getEdgeAttribute(t,"style");if(v[i].metadata.supportLinePathType.includes(n)){const i=structuredClone(C[n].defaultAttrs);let a=-1;if(r&&n!==A.Simple){const[r,s]=e.extremities(t),o=i.startFrom;a=E(e,n,r,s,o)}e.setEdgeAttribute(t,"parallelIndex",a),e.removeEdgeAttribute(t,s),e.mergeEdgeAttributes(t,{type:n,[n]:i})}})),U=e("a",((e,t,n,r)=>{const s=e.getEdgeAttribute(t,"type"),i=e.getEdgeAttribute(t,"style");if(v[n].metadata.supportLinePathType.includes(s)){const s=e.getEdgeAttribute(t,"zIndex"),a=e.getEdgeAttribute(t,i);e.removeEdgeAttribute(t,i);const o=structuredClone(v[n].defaultAttrs);S.has(i)&&S.has(n)?o.color=a.color:S.has(n)&&r&&(o.color=r),e.mergeEdgeAttributes(t,{style:n,[n]:o}),n===T.River?e.setEdgeAttribute(t,"zIndex",-5):e.setEdgeAttribute(t,"zIndex",null!=s?s:0)}}));e("C",(e=>{const{isOpen:n,onClose:x,isSelect:E,filter:Y}=e,{t:Z}=F(),q=w(),{selected:G}=N((e=>e.runtime)),{preference:{autoParallel:Q}}=N((e=>e.app)),{activeSubscriptions:V}=N((e=>e.account)),$=_.useCallback((()=>{q(P()),q(L()),q(k(ee.current.export()))}),[q,P,L,k]),ee=_.useRef(window.graph),te=t({any:Z("header.settings.procedures.changeType.any")},Object.fromEntries(Object.entries(C).map((([e,t])=>[e,Z(t.metadata.displayName).toString()])))),ne=t({any:Z("header.settings.procedures.changeType.any")},Object.fromEntries(Object.entries(v).map((([e,t])=>[e,Z(t.metadata.displayName).toString()])))),re=t({any:Z("header.settings.procedures.changeType.any")},Object.fromEntries(Object.entries(X).map((([e,t])=>[e,Z(t.metadata.displayName).toString()])))),se={id:"any",theme:[I.Other,"other","#ffffff",W.black],value:Z("header.settings.procedures.changeType.any")},[ie,ae]=_.useState(!1),[oe,le]=_.useState(0),[ce,de]=_.useState(!1),[ue,ge]=_.useState("any"),[he,pe]=_.useState(O.ShmetroBasic),[ye,be]=_.useState(!1),[fe,me]=_.useState("any"),[je,Se]=_.useState(T.SingleColor),[Oe,xe]=_.useState(!1),[ve,Ce]=_.useState("any"),[Ae,Ee]=_.useState(A.Diagonal),[Te,we]=_.useState(!1),[Ne,Pe]=_.useState(se),{theme:Le,requestThemeChange:ke}=z(),[Ie,We]=_.useState([]),ze=[{id:"changeZIndex",title:Z("header.settings.procedures.changeZIndex"),onClose:()=>ae(!ie),field:[{type:"select",label:Z("panel.details.info.zIndex"),value:oe,options:Object.fromEntries(Array.from({length:11},((e,t)=>[t-5,(t-5).toString()]))),onChange:e=>le(Number(e))}]},{id:"changeStationType",title:Z("header.settings.procedures.changeStationType.title"),onClose:()=>de(!ce),field:[{type:"select",label:Z("header.settings.procedures.changeStationType.changeFrom"),options:re,value:ue,disabledOptions:[he],onChange:e=>ge(e)},{type:"select",label:Z("header.settings.procedures.changeStationType.changeTo"),options:re,value:he,disabledOptions:["any",ue],onChange:e=>pe(e)}]},{id:"changeLineStyleType",title:Z("header.settings.procedures.changeLineStyleType.title"),onClose:()=>be(!ye),field:[{type:"select",label:Z("header.settings.procedures.changeLineStyleType.changeFrom"),options:ne,value:fe,disabledOptions:[je],onChange:e=>me(e)},{type:"select",label:Z("header.settings.procedures.changeLineStyleType.changeTo"),options:ne,value:je,disabledOptions:["any",fe],onChange:e=>Se(e)}]},{id:"changeLinePathType",title:Z("header.settings.procedures.changeLinePathType.title"),onClose:()=>xe(!Oe),field:[{type:"select",label:Z("header.settings.procedures.changeLinePathType.changeFrom"),options:te,value:ve,disabledOptions:[Ae],onChange:e=>Ce(e)},{type:"select",label:Z("header.settings.procedures.changeLinePathType.changeTo"),options:te,value:Ae,disabledOptions:["any","simple",ve],onChange:e=>Ee(e)}]},{id:"changeColor",title:Z("header.settings.procedures.changeColor.title"),onClose:()=>we(!Te),field:[{type:"custom",label:Z("header.settings.procedures.changeColor.changeFrom"),component:r.jsx(D,{data:Ie,displayHandler:e=>r.jsx(M,{name:e.value,fg:e.theme[3],bg:e.theme[2],title:e.theme[1],sx:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis"}}),filter:(e,t)=>t.id.toLowerCase().includes(e.toLowerCase())||Object.values(t.id).some((t=>t.toLowerCase().includes(e.toLowerCase()))),value:Ne.value,onChange:e=>Pe(e)})},{type:"custom",label:Z("header.settings.procedures.changeColor.changeTo"),component:r.jsx(R,{theme:Le,onClick:ke})}]}];_.useEffect((()=>{n&&(ae(!1),de(!1),be(!1),xe(!1),we(!1),le(0),We([se,...H(ee.current,E?[...G].filter((e=>e.startsWith("stn")||e.startsWith("misc_node"))):ee.current.nodes(),E?[...G].filter((e=>e.startsWith("line"))):ee.current.edges()).map((e=>({id:e.toString(),theme:e,value:"other"===e[1]?e[2]:e[1]})))]),Pe(se))}),[n]);return r.jsxs(s,{isOpen:n,onClose:x,size:"md",scrollBehavior:"inside",children:[r.jsx(i,{}),r.jsxs(a,{children:[r.jsxs(o,{children:[r.jsx(l,{as:"b",fontSize:"xl",children:Z(E?"panel.details.multipleSelection.change":"header.settings.procedures.changeType.title")}),r.jsx(c,{})]}),r.jsx(d,{children:r.jsx(u,{allowMultiple:!0,children:ze.map((e=>r.jsxs(g,{children:[r.jsxs(h,{onClick:e.onClose,children:[r.jsx(p,{as:"span",flex:"1",textAlign:"left",children:r.jsx(l,{as:"b",fontSize:"md",children:e.title})}),r.jsx(y,{})]}),r.jsx(b,{pb:4,children:r.jsx(B,{fields:e.field,minW:270})})]},e.id)))})}),r.jsxs(f,{children:[r.jsx(m,{colorScheme:"blue",variant:"outline",mr:"1",onClick:x,children:Z("cancel")}),r.jsx(j,{label:Z("header.settings.pro"),isOpen:!V.RMP_CLOUD,children:r.jsx(m,{colorScheme:"red",mr:"1",onClick:()=>{const e=null!=Y&&Y.includes("station")?[...G].filter((e=>e.startsWith("stn"))):E?[]:ee.current.filterNodes((e=>e.startsWith("stn"))),t=null!=Y&&Y.includes("misc-node")?[...G].filter((e=>e.startsWith("misc_node"))):E?[]:ee.current.filterNodes((e=>e.startsWith("misc_node"))),n=E?[...G].filter((e=>e.startsWith("line"))):ee.current.edges();Y&&!Y.includes("station")||!ce||((e,t,n,r)=>{r.filter((n=>"any"===t||e.getNodeAttribute(n,"type")===t)).forEach((t=>{J(e,t,n)}))})(ee.current,ue,he,e),Y&&!Y.includes("line")||!ye||((e,t,n,r,s)=>{s.filter((n=>"any"===t||e.getEdgeAttribute(n,"style")===t)).forEach((t=>{U(e,t,n,r)}))})(ee.current,fe,je,Le,n),Y&&!Y.includes("line")||!Oe||((e,t,n,r,s)=>{r.filter((n=>"any"===t||e.getEdgeAttribute(n,"type")===t)).forEach((t=>{K(e,t,n,s)}))})(ee.current,ve,Ae,n,Q),Te&&(Y&&!Y.includes("line")||((e,t,n,r)=>{r.filter((t=>S.has(e.getEdgeAttribute(t,"style")))).forEach((r=>{const s=e.getEdgeAttributes(r),i=s[s.style].color;("any"===t||i[0]==t[0]&&i[1]==t[1]&&i[2]==t[2]&&i[3]==t[3])&&e.mergeEdgeAttributes(r,{[s.style]:{color:n}})}))})(ee.current,"any"===Ne.id?"any":Ne.theme,Le,n),(!Y||Y.includes("misc-node")||Y.includes("station"))&&((e,t,n,r,s)=>{[...r,...s].forEach((r=>{const s=e.getNodeAttributes(r).type,i=e.getNodeAttribute(r,s);if(void 0!==i.color){const e=i.color;("any"===t||e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]&&e[3]==t[3])&&(i.color=n)}e.mergeNodeAttributes(r,{[s]:i})}))})(ee.current,"any"===Ne.id?"any":Ne.theme,Le,e,t)),ie&&((e,t,n,r,s)=>{[...t,...n].forEach((t=>{e.setNodeAttribute(t,"zIndex",s)})),r.forEach((t=>{e.setEdgeAttribute(t,"zIndex",s)}))})(ee.current,e,t,n,oe),$(),x()},isDisabled:!(V.RMP_CLOUD&&(ie||ce||ye||Oe||Te)),children:Z("apply")})})]})]})]})}))}}}))}();
