import{S as u,e as g}from"./index-dryCCfHZ.js";const N=/url\("([\S*]+)"\)/,U=()=>navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome"),b=s=>new Promise(e=>{const t=new FileReader;t.onloadend=()=>e(t.result),t.readAsDataURL(s)}),S=(s,e)=>s.find(t=>{const n=t.style;return n.getPropertyValue("font-family").replace(/^"(.+)"$/,"$1")===e.family&&n.getPropertyValue("unicode-range")===e.unicodeRange}),V=async(s,e,t,n,a)=>{var d,h;const o=Array.from(new Set(e.map(r=>[...s.querySelectorAll(r)]).flat().map(r=>r.innerHTML).join("").replace(/\s/g,""))).join(""),l=await document.fonts.load(t.join(", "),o),i=(h=(d=document.querySelector("link#".concat(n)))==null?void 0:d.sheet)==null?void 0:h.cssRules;if(!i)return Promise.reject(new Error("cssRules can not be found in link#".concat(n)));const c=Array.from(i).flatMap(r=>r instanceof CSSImportRule?Array.from(r.styleSheet.cssRules):r).filter(r=>r instanceof CSSFontFaceRule),m=l.reduce((r,y)=>{const f=S(c,y);return f?r.find(M=>{const _=M.style,p=f.style;return _.getPropertyValue("font-family")===p.getPropertyValue("font-family")&&_.getPropertyValue("unicode-range")===p.getPropertyValue("unicode-range")})?r:r.concat(f):r},[]);return await Promise.all(m.map(async r=>{try{const y=await fetch(x(a,r)),f=await b(await y.blob());return r.cssText.replace(N,"url('".concat(f,"')"))}catch(y){return console.error(y),""}}))},x=(s,e)=>{var n;const t=e.style.getPropertyValue("src");return s+((n=t.match(N))==null?void 0:n[1])},P={[u.MTR]:{className:[".rmp-name__mtr__zh",".rmp-name__mtr__en"],cssFont:["80px GenYoMin TW","Vegur"],cssName:"fonts_mtr",baseUrl:"/styles/"},[u.MRTBasic]:{className:[".rmp-name__mrt"],cssFont:["100% IdentityFont"],cssName:"fonts_mrt",baseUrl:"/rmp/styles/"},[u.MRTInt]:{className:[".rmp-name__mrt"],cssFont:["100% IdentityFont"],cssName:"fonts_mrt",baseUrl:"/rmp/styles/"},[u.JREastBasic]:{className:[".rmp-name__jreast_ja"],cssFont:["100% Noto Sans JP Medium"],cssName:"fonts_jreast",baseUrl:"/rmp/styles/"},[u.JREastImportant]:{className:[".rmp-name__jreast_ja"],cssFont:["100% Noto Sans JP Medium"],cssName:"fonts_jreast",baseUrl:"/rmp/styles/"},[g.BerlinSBahnLineBadge]:{className:[".rmp-name__berlin"],cssFont:["100% Roboto"],cssName:"fonts_berlin",baseUrl:"/rmp/styles/"},[g.BerlinUBahnLineBadge]:{className:[".rmp-name__berlin"],cssFont:["100% Roboto"],cssName:"fonts_berlin",baseUrl:"/rmp/styles/"},[g.JREastLineBadge]:{className:[".rmp-name__jreast_ja"],cssFont:["100% Noto Sans JP Medium"],cssName:"fonts_jreast",baseUrl:"/rmp/styles/"}},j=(s,e)=>s.filterEdges((t,n,a,o,l,i,c)=>e.has(a)&&e.has(o)),B=s=>{const e=Object.fromEntries([...Object.values(u),Object.values(g)].map(t=>[t,!1]));return s.forEachNode(t=>{const n=s.getNodeAttribute(t,"type");e[n]=!0}),e},R=(s,e,t,n,a,o)=>s<=a&&a<=t&&e<=o&&o<=n,L=(s,e,t,n,a)=>{const o=e<=n?e:n,l=t<=a?t:a,i=e<=n?n:e,c=t<=a?a:t;return s.filterNodes((m,d)=>R(o,l,i,c,d.x,d.y))},T=s=>{const e=s.currentTarget.getBoundingClientRect(),t=s.clientX-e.left,n=s.clientY-e.top;return{x:t,y:n}},C=(s,e,t,n)=>({x:s*t/100+n.x,y:e*t/100+n.y}),w=(s,e)=>Math.round(s/e)*e,I=s=>{let[e,t,n,a]=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MIN_VALUE];return s.forEachNode((o,l)=>{const i=document.getElementById(o);if(i){const c=A(i);e=Math.min(c.x,e),t=Math.min(c.y,t),n=Math.max(c.x+c.width,n),a=Math.max(c.y+c.height,a)}}),e-=50,t-=50,n+=100,a+=100,{xMin:e,yMin:t,xMax:n,yMax:a}},A=s=>{const e=s.getBBox(),t=s.ownerSVGElement,n=s.parentNode.getScreenCTM().inverse().multiply(s.getScreenCTM()),a=[t.createSVGPoint(),t.createSVGPoint(),t.createSVGPoint(),t.createSVGPoint()];a[0].x=e.x,a[0].y=e.y,a[1].x=e.x+e.width,a[1].y=e.y,a[2].x=e.x+e.width,a[2].y=e.y+e.height,a[3].x=e.x,a[3].y=e.y+e.height;let[o,l,i,c]=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MIN_VALUE];return a.forEach(m=>{m=m.matrixTransform(n),o=Math.min(o,m.x),i=Math.max(i,m.x),l=Math.min(l,m.y),c=Math.max(c,m.y)}),e.x=o,e.width=i-o,e.y=l,e.height=c-l,e},G=navigator.platform.startsWith("Mac"),X=s=>{for(let e=s.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[s[e],s[t]]=[s[t],s[e]]}return s};export{P as F,G as a,T as b,I as c,L as d,j as e,B as f,V as g,U as i,C as p,w as r,X as s};
