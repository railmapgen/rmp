!function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?e(Object(s),!0).forEach((function(e){n(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):e(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function n(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}System.register(["./chakra-legacy-BwGWQky_.js","./index-legacy-DwQtYsgA.js","./react-legacy-B-tEtBDe.js","./master-manager-legacy-B04ENZNE.js"],(function(e,n){"use strict";var r,s,i,a,o,l,c,d,u,g,h,p,y,b,f,m,j,S,O,v,x,A,C,E,T,P,w,N,L,k,I,W,z,D,M,R,B,F,_,H,J;return{setters:[e=>{r=e.j,s=e.ag,i=e.M,a=e.ah,o=e.J,l=e.N,c=e.K,d=e.L,u=e.aG,g=e.aH,h=e.aI,p=e.B,y=e.aJ,b=e.aK,f=e.O,m=e.t,j=e.ax},e=>{S=e.L,O=e.S,v=e.aP,x=e.aw,A=e.o,C=e.k,E=e.m,T=e.l,P=e.c,w=e.d,N=e.q,L=e.t,k=e.v,I=e.C,W=e.M,z=e.Q,D=e.R,M=e.V,R=e.W,B=e.i},e=>{F=e.u,_=e.b},e=>{H=e.s,J=e.n}],execute:function(){const n=[O.ShmetroBasic2020,O.LondonTubeBasic,O.ShanghaiSuburbanRailway],K=e("b",((e,r,s)=>{const i=e.getNodeAttribute(r,"type"),a=structuredClone(e.getNodeAttribute(r,i).names);for(let t=0;t<Math.abs(H[s].defaultAttrs.names.length-a.length);t++)H[s].defaultAttrs.names.length>a.length?a.push("Stn"):a.pop();const o=t(t({},H[s].defaultAttrs),{},{names:a});Object.values(n).includes(i)&&Object.values(n).includes(s)||(o.nameOffsetX=e.getNodeAttribute(r,i).nameOffsetX,o.nameOffsetY=e.getNodeAttribute(r,i).nameOffsetY),v.includes(s)&&v.includes(i)&&(o.color=structuredClone(e.getNodeAttribute(r,i).color)),e.removeNodeAttribute(r,i),e.mergeNodeAttributes(r,{type:s,[s]:o})})),U=e("c",((e,t,n,r)=>{const s=e.getEdgeAttribute(t,"type"),i=e.getEdgeAttribute(t,"style");if(x[i].metadata.supportLinePathType.includes(n)){const i=structuredClone(A[n].defaultAttrs);let a=-1;if(r&&n!==C.Simple){const[r,s]=e.extremities(t),o=i.startFrom;a=E(e,n,r,s,o)}e.setEdgeAttribute(t,"parallelIndex",a),e.removeEdgeAttribute(t,s),e.mergeEdgeAttributes(t,{type:n,[n]:i})}})),X=e("a",((e,t,n,r)=>{const s=e.getEdgeAttribute(t,"type"),i=e.getEdgeAttribute(t,"style");if(x[n].metadata.supportLinePathType.includes(s)){const s=e.getEdgeAttribute(t,"zIndex"),a=e.getEdgeAttribute(t,i);e.removeEdgeAttribute(t,i);const o=structuredClone(x[n].defaultAttrs);S.has(i)&&S.has(n)?o.color=a.color:S.has(n)&&r&&(o.color=r),e.mergeEdgeAttributes(t,{style:n,[n]:o}),n===T.River?e.setEdgeAttribute(t,"zIndex",-5):e.setEdgeAttribute(t,"zIndex",null!=s?s:0)}}));e("C",(e=>{const{isOpen:n,onClose:v,isSelect:E,filter:Y}=e,{t:Z}=F(),q=P(),{selected:G,theme:Q,paletteAppClip:{output:V}}=w((e=>e.runtime)),{preference:{autoParallel:$}}=w((e=>e.app)),{activeSubscriptions:ee}=w((e=>e.account)),te=_.useCallback((()=>{q(N()),q(L()),q(k(ne.current.export()))}),[q,N,L,k]),ne=_.useRef(window.graph),re=t({any:Z("header.settings.procedures.changeType.any")},Object.fromEntries(Object.entries(A).map((([e,t])=>[e,Z(t.metadata.displayName).toString()])))),se=t({any:Z("header.settings.procedures.changeType.any")},Object.fromEntries(Object.entries(x).map((([e,t])=>[e,Z(t.metadata.displayName).toString()])))),ie=t({any:Z("header.settings.procedures.changeType.any")},Object.fromEntries(Object.entries(H).map((([e,t])=>[e,Z(t.metadata.displayName).toString()])))),ae={id:"any",theme:[I.Other,"other","#ffffff",W.black],value:Z("header.settings.procedures.changeType.any")},[oe,le]=_.useState(!1),[ce,de]=_.useState(0),[ue,ge]=_.useState(!1),[he,pe]=_.useState("any"),[ye,be]=_.useState(O.ShmetroBasic),[fe,me]=_.useState(!1),[je,Se]=_.useState("any"),[Oe,ve]=_.useState(T.SingleColor),[xe,Ae]=_.useState(!1),[Ce,Ee]=_.useState("any"),[Te,Pe]=_.useState(C.Diagonal),[we,Ne]=_.useState(!1),[Le,ke]=_.useState(ae),[Ie,We]=_.useState(Q),[ze,De]=_.useState(!1);_.useEffect((()=>{ze&&V&&(We(V),De(!1))}),[null==V?void 0:V.toString()]);const[Me,Re]=_.useState([]),Be=[{id:"changeZIndex",title:Z("header.settings.procedures.changeZIndex"),onClose:()=>le(!oe),field:[{type:"select",label:Z("panel.details.info.zIndex"),value:ce,options:Object.fromEntries(Array.from({length:11},((e,t)=>[t-5,(t-5).toString()]))),onChange:e=>de(Number(e))}]},{id:"changeStationType",title:Z("header.settings.procedures.changeStationType.title"),onClose:()=>ge(!ue),field:[{type:"select",label:Z("header.settings.procedures.changeStationType.changeFrom"),options:ie,value:he,disabledOptions:[ye],onChange:e=>pe(e)},{type:"select",label:Z("header.settings.procedures.changeStationType.changeTo"),options:ie,value:ye,disabledOptions:["any",he],onChange:e=>be(e)}]},{id:"changeLineStyleType",title:Z("header.settings.procedures.changeLineStyleType.title"),onClose:()=>me(!fe),field:[{type:"select",label:Z("header.settings.procedures.changeLineStyleType.changeFrom"),options:se,value:je,disabledOptions:[Oe],onChange:e=>Se(e)},{type:"select",label:Z("header.settings.procedures.changeLineStyleType.changeTo"),options:se,value:Oe,disabledOptions:["any",je],onChange:e=>ve(e)}]},{id:"changeLinePathType",title:Z("header.settings.procedures.changeLinePathType.title"),onClose:()=>Ae(!xe),field:[{type:"select",label:Z("header.settings.procedures.changeLinePathType.changeFrom"),options:re,value:Ce,disabledOptions:[Te],onChange:e=>Ee(e)},{type:"select",label:Z("header.settings.procedures.changeLinePathType.changeTo"),options:re,value:Te,disabledOptions:["any","simple",Ce],onChange:e=>Pe(e)}]},{id:"changeColor",title:Z("header.settings.procedures.changeColor.title"),onClose:()=>Ne(!we),field:[{type:"custom",label:Z("header.settings.procedures.changeColor.changeFrom"),component:r.jsx(z,{data:Me,displayHandler:e=>r.jsx(D,{name:e.value,fg:e.theme[3],bg:e.theme[2],title:e.theme[1],sx:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis"}}),filter:(e,t)=>t.id.toLowerCase().includes(e.toLowerCase())||Object.values(t.id).some((t=>t.toLowerCase().includes(e.toLowerCase()))),value:Le.value,onChange:e=>ke(e)})},{type:"custom",label:Z("header.settings.procedures.changeColor.changeTo"),component:r.jsx(M,{theme:Ie,onClick:()=>{De(!0),q(R(Q))}})}]}];_.useEffect((()=>{n&&(le(!1),ge(!1),me(!1),Ae(!1),Ne(!1),de(0),Re([ae,...J(ne.current,E?[...G].filter((e=>e.startsWith("stn")||e.startsWith("misc_node"))):ne.current.nodes(),E?[...G].filter((e=>e.startsWith("line"))):ne.current.edges()).map((e=>({id:e.toString(),theme:e,value:"other"===e[1]?e[2]:e[1]})))]),ke(ae))}),[n]);return r.jsxs(s,{isOpen:n,onClose:v,size:"md",scrollBehavior:"inside",children:[r.jsx(i,{}),r.jsxs(a,{children:[r.jsxs(o,{children:[r.jsx(l,{as:"b",fontSize:"xl",children:Z(E?"panel.details.multipleSelection.change":"header.settings.procedures.changeType.title")}),r.jsx(c,{})]}),r.jsx(d,{children:r.jsx(u,{allowMultiple:!0,children:Be.map((e=>r.jsxs(g,{children:[r.jsxs(h,{onClick:e.onClose,children:[r.jsx(p,{as:"span",flex:"1",textAlign:"left",children:r.jsx(l,{as:"b",fontSize:"md",children:e.title})}),r.jsx(y,{})]}),r.jsx(b,{pb:4,children:r.jsx(B,{fields:e.field,minW:270})})]},e.id)))})}),r.jsxs(f,{children:[r.jsx(m,{colorScheme:"blue",variant:"outline",mr:"1",onClick:v,children:Z("cancel")}),r.jsx(j,{label:Z("header.settings.pro"),isOpen:!ee.RMP_CLOUD,children:r.jsx(m,{colorScheme:"red",mr:"1",onClick:()=>{const e=null!=Y&&Y.includes("station")?[...G].filter((e=>e.startsWith("stn"))):E?[]:ne.current.filterNodes((e=>e.startsWith("stn"))),t=null!=Y&&Y.includes("misc-node")?[...G].filter((e=>e.startsWith("misc_node"))):E?[]:ne.current.filterNodes((e=>e.startsWith("misc_node"))),n=E?[...G].filter((e=>e.startsWith("line"))):ne.current.edges();Y&&!Y.includes("station")||!ue||((e,t,n,r)=>{r.filter((n=>"any"===t||e.getNodeAttribute(n,"type")===t)).forEach((t=>{K(e,t,n)}))})(ne.current,he,ye,e),Y&&!Y.includes("line")||!fe||((e,t,n,r,s)=>{s.filter((n=>"any"===t||e.getEdgeAttribute(n,"style")===t)).forEach((t=>{X(e,t,n,r)}))})(ne.current,je,Oe,Q,n),Y&&!Y.includes("line")||!xe||((e,t,n,r,s)=>{r.filter((n=>"any"===t||e.getEdgeAttribute(n,"type")===t)).forEach((t=>{U(e,t,n,s)}))})(ne.current,Ce,Te,n,$),we&&(Y&&!Y.includes("line")||((e,t,n,r)=>{r.filter((t=>S.has(e.getEdgeAttribute(t,"style")))).forEach((r=>{const s=e.getEdgeAttributes(r),i=s[s.style].color;("any"===t||i[0]==t[0]&&i[1]==t[1]&&i[2]==t[2]&&i[3]==t[3])&&e.mergeEdgeAttributes(r,{[s.style]:{color:n}})}))})(ne.current,"any"===Le.id?"any":Le.theme,Ie,n),(!Y||Y.includes("misc-node")||Y.includes("station"))&&((e,t,n,r,s)=>{[...r,...s].forEach((r=>{const s=e.getNodeAttributes(r).type,i=e.getNodeAttribute(r,s);if(void 0!==i.color){const e=i.color;("any"===t||e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]&&e[3]==t[3])&&(i.color=n)}e.mergeNodeAttributes(r,{[s]:i})}))})(ne.current,"any"===Le.id?"any":Le.theme,Ie,e,t)),oe&&((e,t,n,r,s)=>{[...t,...n].forEach((t=>{e.setNodeAttribute(t,"zIndex",s)})),r.forEach((t=>{e.setEdgeAttribute(t,"zIndex",s)}))})(ne.current,e,t,n,ce),te(),v()},isDisabled:!(ee.RMP_CLOUD&&(oe||ue||fe||xe||we)),children:Z("apply")})})]})]})]})}))}}}))}();
